{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport dayjs from 'dayjs';\nimport React, { useCallback, useContext, useEffect, useMemo, useState } from 'react';\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport InteractionManager from \"react-native-web/dist/exports/InteractionManager\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { PropsContext } from \"./Chatty\";\nimport { ReplyingTo } from \"./components/ReplyingTo\";\nimport { UrlPreviewBubble } from \"./components/UrlPreviewBubble\";\nimport { MediaType, MessageStatus } from \"./types/Chatty.types\";\nimport { ChatEmitter } from \"./utils/eventEmitter\";\nimport { extractUrlFromString, fetchMetaData } from \"./utils/helpers\";\nimport { Skeleton } from \"./utils/moti\";\nimport { ALL_PATERNS_SHAPES, HASHTAG_PATTERN_SHAPE, LoadAllPaternShapes, loadParsedText, MENTION_PATTERN_SHAPE, URL_PATTERN_SHAPE } from \"./utils/patterns\";\nimport { PhotoView } from \"./utils/photoView\";\nimport { ContextMenuWrapper } from \"./wrappers/ContextMenuWrapper\";\nvar ParsedText = loadParsedText();\n\nfunction _ChatBubble(props) {\n  var _propsContext$bubbleP7, _propsContext$bubbleP8, _propsContext$bubbleP18, _propsContext$bubbleP19, _propsContext$bubbleP20, _propsContext$pattern3, _propsContext$pattern4, _propsContext$bubbleP33, _propsContext$bubbleP34, _propsContext$bubbleP35, _propsContext$bubbleP36, _propsContext$bubbleP37, _propsContext$bubbleP38, _propsContext$bubbleP39, _propsContext$bubbleP40, _propsContext$bubbleP43, _propsContext$bubbleP45, _propsContext$listPro7, _propsContext$listPro8, _propsContext$bubbleP46, _propsContext$bubbleP47, _propsContext$bubbleP48, _message$user$avatar, _propsContext$bubbleP49, _message$repliedTo, _propsContext$bubbleP50, _propsContext$bubbleP51, _message$me2, _propsContext$bubbleP52, _propsContext$bubbleP53, _message$me3, _propsContext$bubbleP54, _propsContext$bubbleP55, _message$user$avatar2, _propsContext$bubbleP56;\n\n  var message = props.message,\n      children = props.children;\n  var propsContext = useContext(PropsContext);\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      mediaLoaded = _useState2[0],\n      setMediaLoaded = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      showMedia = _useState4[0],\n      setShowMedia = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      showUrlPreview = _useState6[0],\n      setShowUrlPreview = _useState6[1];\n\n  var _useState7 = useState(),\n      _useState8 = _slicedToArray(_useState7, 2),\n      urlPreviewData = _useState8[0],\n      setUrlPreviewData = _useState8[1];\n\n  var createdAt = useMemo(function () {\n    return message && dayjs(message.createdAt).format('HH:mm');\n  }, [message]);\n  var avatarSize = useMemo(function () {\n    var _propsContext$bubbleP, _propsContext$bubbleP2, _propsContext$bubbleP3, _propsContext$bubbleP4, _propsContext$bubbleP5, _propsContext$bubbleP6;\n\n    return {\n      width: ((_propsContext$bubbleP = propsContext.bubbleProps) === null || _propsContext$bubbleP === void 0 ? void 0 : (_propsContext$bubbleP2 = _propsContext$bubbleP.showAvatars) === null || _propsContext$bubbleP2 === void 0 ? void 0 : _propsContext$bubbleP2.width) || 40,\n      height: ((_propsContext$bubbleP3 = propsContext.bubbleProps) === null || _propsContext$bubbleP3 === void 0 ? void 0 : (_propsContext$bubbleP4 = _propsContext$bubbleP3.showAvatars) === null || _propsContext$bubbleP4 === void 0 ? void 0 : _propsContext$bubbleP4.width) || 40,\n      borderRadius: ((_propsContext$bubbleP5 = propsContext.bubbleProps) === null || _propsContext$bubbleP5 === void 0 ? void 0 : (_propsContext$bubbleP6 = _propsContext$bubbleP5.showAvatars) === null || _propsContext$bubbleP6 === void 0 ? void 0 : _propsContext$bubbleP6.width) || 40\n    };\n  }, [(_propsContext$bubbleP7 = propsContext.bubbleProps) === null || _propsContext$bubbleP7 === void 0 ? void 0 : (_propsContext$bubbleP8 = _propsContext$bubbleP7.showAvatars) === null || _propsContext$bubbleP8 === void 0 ? void 0 : _propsContext$bubbleP8.width]);\n  var bubbleBackgroundColor = useMemo(function () {\n    var _propsContext$bubbleP9, _propsContext$bubbleP16, _propsContext$bubbleP17;\n\n    if ((_propsContext$bubbleP9 = propsContext.bubbleProps) !== null && _propsContext$bubbleP9 !== void 0 && _propsContext$bubbleP9.containerStyle) {\n      if (message !== null && message !== void 0 && message.me) {\n        var _propsContext$bubbleP10, _propsContext$bubbleP11;\n\n        return _objectSpread({\n          backgroundColor: (_propsContext$bubbleP10 = propsContext === null || propsContext === void 0 ? void 0 : (_propsContext$bubbleP11 = propsContext.bubbleProps) === null || _propsContext$bubbleP11 === void 0 ? void 0 : _propsContext$bubbleP11.selfBubbleColor) !== null && _propsContext$bubbleP10 !== void 0 ? _propsContext$bubbleP10 : '#afddfa'\n        }, propsContext.bubbleProps.containerStyle);\n      } else {\n        var _propsContext$bubbleP12, _propsContext$bubbleP13;\n\n        return _objectSpread({\n          backgroundColor: (_propsContext$bubbleP12 = propsContext === null || propsContext === void 0 ? void 0 : (_propsContext$bubbleP13 = propsContext.bubbleProps) === null || _propsContext$bubbleP13 === void 0 ? void 0 : _propsContext$bubbleP13.otherBubbleColor) !== null && _propsContext$bubbleP12 !== void 0 ? _propsContext$bubbleP12 : '#c8faaf'\n        }, propsContext.bubbleProps.containerStyle);\n      }\n    }\n\n    if (message !== null && message !== void 0 && message.me) {\n      var _propsContext$bubbleP14, _propsContext$bubbleP15;\n\n      return {\n        backgroundColor: (_propsContext$bubbleP14 = propsContext === null || propsContext === void 0 ? void 0 : (_propsContext$bubbleP15 = propsContext.bubbleProps) === null || _propsContext$bubbleP15 === void 0 ? void 0 : _propsContext$bubbleP15.selfBubbleColor) !== null && _propsContext$bubbleP14 !== void 0 ? _propsContext$bubbleP14 : '#afddfa'\n      };\n    }\n\n    return {\n      backgroundColor: (_propsContext$bubbleP16 = propsContext === null || propsContext === void 0 ? void 0 : (_propsContext$bubbleP17 = propsContext.bubbleProps) === null || _propsContext$bubbleP17 === void 0 ? void 0 : _propsContext$bubbleP17.otherBubbleColor) !== null && _propsContext$bubbleP16 !== void 0 ? _propsContext$bubbleP16 : '#c8faaf'\n    };\n  }, [message === null || message === void 0 ? void 0 : message.me, propsContext === null || propsContext === void 0 ? void 0 : (_propsContext$bubbleP18 = propsContext.bubbleProps) === null || _propsContext$bubbleP18 === void 0 ? void 0 : _propsContext$bubbleP18.otherBubbleColor, propsContext === null || propsContext === void 0 ? void 0 : (_propsContext$bubbleP19 = propsContext.bubbleProps) === null || _propsContext$bubbleP19 === void 0 ? void 0 : _propsContext$bubbleP19.selfBubbleColor, (_propsContext$bubbleP20 = propsContext.bubbleProps) === null || _propsContext$bubbleP20 === void 0 ? void 0 : _propsContext$bubbleP20.containerStyle]);\n  var bubbleAlignment = useMemo(function () {\n    if (message !== null && message !== void 0 && message.me) {\n      return {\n        alignSelf: 'flex-end'\n      };\n    }\n\n    return {\n      alignSelf: 'flex-start'\n    };\n  }, [message === null || message === void 0 ? void 0 : message.me]);\n  useEffect(function () {\n    if (message !== null && message !== void 0 && message.media) {\n      message.media.forEach(function (media) {\n        if (media.type === MediaType.Image) {\n          InteractionManager.runAfterInteractions(function () {\n            Image.prefetch(media.uri).then(function () {\n              setMediaLoaded(true);\n            });\n          });\n        }\n      });\n    }\n\n    if (propsContext.enableUrlPreviews) {\n      InteractionManager.runAfterInteractions(function _callee() {\n        var _message$text, url, data;\n\n        return _regeneratorRuntime.async(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                url = extractUrlFromString((_message$text = message === null || message === void 0 ? void 0 : message.text) !== null && _message$text !== void 0 ? _message$text : '');\n\n                if (!url) {\n                  _context.next = 6;\n                  break;\n                }\n\n                _context.next = 4;\n                return _regeneratorRuntime.awrap(fetchMetaData(url));\n\n              case 4:\n                data = _context.sent;\n\n                if (data) {\n                  setShowUrlPreview(true);\n                  setUrlPreviewData(data);\n                }\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, null, null, null, Promise);\n      });\n    }\n  }, [message === null || message === void 0 ? void 0 : message.media, message === null || message === void 0 ? void 0 : message.text, propsContext.enableUrlPreviews]);\n  var onPressPattern = useCallback(function (pattern, index) {\n    if (!message) return;\n    ChatEmitter === null || ChatEmitter === void 0 ? void 0 : ChatEmitter.emit('patternPressed', pattern, index, message);\n  }, [message]);\n  var messagePatterns = useMemo(function () {\n    var _propsContext$pattern, _propsContext$pattern2;\n\n    var patterns = [];\n    if (!(propsContext !== null && propsContext !== void 0 && propsContext.enablePatterns)) return;\n    if (!ParsedText) return;\n    LoadAllPaternShapes(onPressPattern);\n\n    if ((_propsContext$pattern = propsContext.patternProps) !== null && _propsContext$pattern !== void 0 && _propsContext$pattern.customPatterns) {\n      patterns.push.apply(patterns, _toConsumableArray(propsContext.patternProps.customPatterns));\n    }\n\n    if (propsContext !== null && propsContext !== void 0 && (_propsContext$pattern2 = propsContext.patternProps) !== null && _propsContext$pattern2 !== void 0 && _propsContext$pattern2.allowPatterns) {\n      propsContext.patternProps.allowPatterns.forEach(function (pattern) {\n        switch (pattern) {\n          case 'hashtag':\n            patterns.push(HASHTAG_PATTERN_SHAPE);\n            break;\n\n          case 'mention':\n            patterns.push(MENTION_PATTERN_SHAPE);\n            break;\n\n          case 'url':\n            patterns.push(URL_PATTERN_SHAPE);\n            break;\n        }\n      });\n    } else {\n      ALL_PATERNS_SHAPES.forEach(function (pattern) {\n        return patterns.push(pattern);\n      });\n    }\n\n    return patterns;\n  }, [onPressPattern, propsContext === null || propsContext === void 0 ? void 0 : propsContext.enablePatterns, propsContext === null || propsContext === void 0 ? void 0 : (_propsContext$pattern3 = propsContext.patternProps) === null || _propsContext$pattern3 === void 0 ? void 0 : _propsContext$pattern3.allowPatterns, propsContext === null || propsContext === void 0 ? void 0 : (_propsContext$pattern4 = propsContext.patternProps) === null || _propsContext$pattern4 === void 0 ? void 0 : _propsContext$pattern4.customPatterns]);\n  var renderTicks = useCallback(function () {\n    var _propsContext$bubbleP21, _propsContext$bubbleP22, _propsContext$bubbleP23, _propsContext$bubbleP24, _propsContext$bubbleP25, _propsContext$bubbleP26, _propsContext$bubbleP27, _propsContext$bubbleP28, _propsContext$bubbleP29, _propsContext$bubbleP30, _propsContext$bubbleP31, _propsContext$bubbleP32;\n\n    if (message !== null && message !== void 0 && message.status) {\n      switch (message.status) {\n        case MessageStatus.Sending:\n          return (_propsContext$bubbleP21 = (_propsContext$bubbleP22 = propsContext.bubbleProps) === null || _propsContext$bubbleP22 === void 0 ? void 0 : (_propsContext$bubbleP23 = _propsContext$bubbleP22.tickProps) === null || _propsContext$bubbleP23 === void 0 ? void 0 : _propsContext$bubbleP23.sendingElement) !== null && _propsContext$bubbleP21 !== void 0 ? _propsContext$bubbleP21 : React.createElement(Text, null, \"\\uD83D\\uDD04\");\n\n        case MessageStatus.Sent:\n          return (_propsContext$bubbleP24 = (_propsContext$bubbleP25 = propsContext.bubbleProps) === null || _propsContext$bubbleP25 === void 0 ? void 0 : (_propsContext$bubbleP26 = _propsContext$bubbleP25.tickProps) === null || _propsContext$bubbleP26 === void 0 ? void 0 : _propsContext$bubbleP26.sentElement) !== null && _propsContext$bubbleP24 !== void 0 ? _propsContext$bubbleP24 : React.createElement(Text, null, \"\\u2714\");\n\n        case MessageStatus.Delivered:\n          return (_propsContext$bubbleP27 = (_propsContext$bubbleP28 = propsContext.bubbleProps) === null || _propsContext$bubbleP28 === void 0 ? void 0 : (_propsContext$bubbleP29 = _propsContext$bubbleP28.tickProps) === null || _propsContext$bubbleP29 === void 0 ? void 0 : _propsContext$bubbleP29.deliveredElement) !== null && _propsContext$bubbleP27 !== void 0 ? _propsContext$bubbleP27 : React.createElement(Text, null, \"\\u2611\");\n\n        case MessageStatus.Read:\n          return (_propsContext$bubbleP30 = (_propsContext$bubbleP31 = propsContext.bubbleProps) === null || _propsContext$bubbleP31 === void 0 ? void 0 : (_propsContext$bubbleP32 = _propsContext$bubbleP31.tickProps) === null || _propsContext$bubbleP32 === void 0 ? void 0 : _propsContext$bubbleP32.readElement) !== null && _propsContext$bubbleP30 !== void 0 ? _propsContext$bubbleP30 : React.createElement(Text, null, \"\\u2705\");\n      }\n    }\n\n    return null;\n  }, [message === null || message === void 0 ? void 0 : message.status, (_propsContext$bubbleP33 = propsContext.bubbleProps) === null || _propsContext$bubbleP33 === void 0 ? void 0 : (_propsContext$bubbleP34 = _propsContext$bubbleP33.tickProps) === null || _propsContext$bubbleP34 === void 0 ? void 0 : _propsContext$bubbleP34.deliveredElement, (_propsContext$bubbleP35 = propsContext.bubbleProps) === null || _propsContext$bubbleP35 === void 0 ? void 0 : (_propsContext$bubbleP36 = _propsContext$bubbleP35.tickProps) === null || _propsContext$bubbleP36 === void 0 ? void 0 : _propsContext$bubbleP36.readElement, (_propsContext$bubbleP37 = propsContext.bubbleProps) === null || _propsContext$bubbleP37 === void 0 ? void 0 : (_propsContext$bubbleP38 = _propsContext$bubbleP37.tickProps) === null || _propsContext$bubbleP38 === void 0 ? void 0 : _propsContext$bubbleP38.sendingElement, (_propsContext$bubbleP39 = propsContext.bubbleProps) === null || _propsContext$bubbleP39 === void 0 ? void 0 : (_propsContext$bubbleP40 = _propsContext$bubbleP39.tickProps) === null || _propsContext$bubbleP40 === void 0 ? void 0 : _propsContext$bubbleP40.sentElement]);\n  var renderFooter = useCallback(function () {\n    var _propsContext$bubbleP41, _propsContext$bubbleP42, _message$me;\n\n    return React.createElement(View, {\n      style: styles.bubbleFooter\n    }, React.createElement(Text, {\n      style: [styles.date, (propsContext === null || propsContext === void 0 ? void 0 : (_propsContext$bubbleP41 = propsContext.bubbleProps) === null || _propsContext$bubbleP41 === void 0 ? void 0 : _propsContext$bubbleP41.dateStyle) && (propsContext === null || propsContext === void 0 ? void 0 : (_propsContext$bubbleP42 = propsContext.bubbleProps) === null || _propsContext$bubbleP42 === void 0 ? void 0 : _propsContext$bubbleP42.dateStyle((_message$me = message === null || message === void 0 ? void 0 : message.me) !== null && _message$me !== void 0 ? _message$me : false))]\n    }, createdAt), renderTicks());\n  }, [createdAt, message === null || message === void 0 ? void 0 : message.me, propsContext === null || propsContext === void 0 ? void 0 : (_propsContext$bubbleP43 = propsContext.bubbleProps) === null || _propsContext$bubbleP43 === void 0 ? void 0 : _propsContext$bubbleP43.dateStyle, renderTicks]);\n  var renderCornerRounding = useCallback(function () {\n    var _propsContext$bubbleP44;\n\n    if (((_propsContext$bubbleP44 = propsContext.bubbleProps) === null || _propsContext$bubbleP44 === void 0 ? void 0 : _propsContext$bubbleP44.enableCornerRounding) === false) return null;\n\n    if (message !== null && message !== void 0 && message.me) {\n      var _propsContext$listPro, _propsContext$listPro2, _propsContext$listPro3;\n\n      return React.createElement(React.Fragment, null, React.createElement(View, {\n        style: [styles.rightArrow, bubbleBackgroundColor]\n      }), React.createElement(View, {\n        style: [styles.rightArrowOverlap, {\n          backgroundColor: (_propsContext$listPro = (_propsContext$listPro2 = propsContext.listProps) === null || _propsContext$listPro2 === void 0 ? void 0 : (_propsContext$listPro3 = _propsContext$listPro2.containerStyle) === null || _propsContext$listPro3 === void 0 ? void 0 : _propsContext$listPro3.backgroundColor) !== null && _propsContext$listPro !== void 0 ? _propsContext$listPro : '#fff'\n        }]\n      }));\n    } else {\n      var _propsContext$listPro4, _propsContext$listPro5, _propsContext$listPro6;\n\n      return React.createElement(React.Fragment, null, React.createElement(View, {\n        style: [styles.leftArrow, bubbleBackgroundColor]\n      }), React.createElement(View, {\n        style: [styles.leftArrowOverlap, {\n          backgroundColor: (_propsContext$listPro4 = (_propsContext$listPro5 = propsContext.listProps) === null || _propsContext$listPro5 === void 0 ? void 0 : (_propsContext$listPro6 = _propsContext$listPro5.containerStyle) === null || _propsContext$listPro6 === void 0 ? void 0 : _propsContext$listPro6.backgroundColor) !== null && _propsContext$listPro4 !== void 0 ? _propsContext$listPro4 : '#fff'\n        }]\n      }));\n    }\n  }, [bubbleBackgroundColor, message === null || message === void 0 ? void 0 : message.me, (_propsContext$bubbleP45 = propsContext.bubbleProps) === null || _propsContext$bubbleP45 === void 0 ? void 0 : _propsContext$bubbleP45.enableCornerRounding, (_propsContext$listPro7 = propsContext.listProps) === null || _propsContext$listPro7 === void 0 ? void 0 : (_propsContext$listPro8 = _propsContext$listPro7.containerStyle) === null || _propsContext$listPro8 === void 0 ? void 0 : _propsContext$listPro8.backgroundColor]);\n  var renderMedia = useCallback(function () {\n    if (message !== null && message !== void 0 && message.media) {\n      var _message$media$;\n\n      return React.createElement(View, {\n        style: {\n          flexDirection: 'row',\n          flexWrap: 'wrap'\n        }\n      }, message === null || message === void 0 ? void 0 : message.media.map(function (media, index) {\n        if (index < 3) {\n          return React.createElement(TouchableOpacity, {\n            onPress: function onPress() {\n              return setShowMedia(true);\n            }\n          }, media.type === MediaType.Image && React.createElement(Skeleton, {\n            show: !mediaLoaded\n          }, React.createElement(Image, {\n            source: {\n              uri: media.uri\n            },\n            style: styles.media\n          })));\n        }\n\n        return null;\n      }), message.media.length > 3 && React.createElement(TouchableOpacity, {\n        onPress: function onPress() {\n          return setShowMedia(true);\n        }\n      }, React.createElement(ImageBackground, {\n        style: styles.media,\n        source: {\n          uri: (_message$media$ = message.media[3]) === null || _message$media$ === void 0 ? void 0 : _message$media$.uri\n        },\n        imageStyle: {\n          borderRadius: 15\n        }\n      }, React.createElement(View, {\n        style: styles.backgroundOverlay\n      }, React.createElement(Text, {\n        style: {\n          color: '#fff',\n          textAlign: 'center',\n          fontSize: 20\n        }\n      }, \"+ \", message.media.length - 3)))), PhotoView && React.createElement(PhotoView, {\n        images: message === null || message === void 0 ? void 0 : message.media,\n        imageIndex: 0,\n        visible: showMedia,\n        onRequestClose: function onRequestClose() {\n          return setShowMedia(false);\n        }\n      }));\n    }\n\n    return null;\n  }, [mediaLoaded, message, showMedia]);\n  var renderUrlPreview = useMemo(function () {\n    if (showUrlPreview && urlPreviewData && !(message !== null && message !== void 0 && message.repliedTo)) {\n      return React.createElement(View, {\n        style: {\n          marginTop: 10\n        }\n      }, React.createElement(UrlPreviewBubble, {\n        title: urlPreviewData.title,\n        description: urlPreviewData.description,\n        image: urlPreviewData.image,\n        url: urlPreviewData.url\n      }));\n    }\n\n    return null;\n  }, [message === null || message === void 0 ? void 0 : message.repliedTo, showUrlPreview, urlPreviewData]);\n  return React.createElement(View, {\n    style: [styles.wrapper, bubbleAlignment]\n  }, ((_propsContext$bubbleP46 = propsContext.bubbleProps) === null || _propsContext$bubbleP46 === void 0 ? void 0 : _propsContext$bubbleP46.trailingAccessory) && (message === null || message === void 0 ? void 0 : message.me) && React.createElement(View, null, propsContext.bubbleProps.trailingAccessory), ((_propsContext$bubbleP47 = propsContext.bubbleProps) === null || _propsContext$bubbleP47 === void 0 ? void 0 : (_propsContext$bubbleP48 = _propsContext$bubbleP47.showAvatars) === null || _propsContext$bubbleP48 === void 0 ? void 0 : _propsContext$bubbleP48.visible) && !(message !== null && message !== void 0 && message.me) && React.createElement(Image, {\n    source: (_message$user$avatar = message === null || message === void 0 ? void 0 : message.user.avatar) !== null && _message$user$avatar !== void 0 ? _message$user$avatar : require(\"./assets/images/noavatar.png\"),\n    style: [styles.avatar, avatarSize]\n  }), React.createElement(ContextMenuWrapper, {\n    message: message\n  }, React.createElement(View, {\n    style: [bubbleBackgroundColor, styles.container, (_propsContext$bubbleP49 = propsContext.bubbleProps) === null || _propsContext$bubbleP49 === void 0 ? void 0 : _propsContext$bubbleP49.containerStyle, {\n      padding: message !== null && message !== void 0 && message.repliedTo ? 5 : 15\n    }]\n  }, children ? children : React.createElement(React.Fragment, null, (message === null || message === void 0 ? void 0 : message.repliedTo) && React.createElement(ReplyingTo, {\n    username: message === null || message === void 0 ? void 0 : (_message$repliedTo = message.repliedTo) === null || _message$repliedTo === void 0 ? void 0 : _message$repliedTo.user.username,\n    text: message === null || message === void 0 ? void 0 : message.repliedTo.text,\n    messageId: message === null || message === void 0 ? void 0 : message.repliedTo.id\n  }), propsContext !== null && propsContext !== void 0 && propsContext.enablePatterns && ParsedText ? React.createElement(React.Fragment, null, renderMedia(), React.createElement(ParsedText, {\n    parse: messagePatterns,\n    style: (propsContext === null || propsContext === void 0 ? void 0 : (_propsContext$bubbleP50 = propsContext.bubbleProps) === null || _propsContext$bubbleP50 === void 0 ? void 0 : _propsContext$bubbleP50.labelStyle) && ((_propsContext$bubbleP51 = propsContext.bubbleProps) === null || _propsContext$bubbleP51 === void 0 ? void 0 : _propsContext$bubbleP51.labelStyle((_message$me2 = message === null || message === void 0 ? void 0 : message.me) !== null && _message$me2 !== void 0 ? _message$me2 : false))\n  }, message === null || message === void 0 ? void 0 : message.text), renderUrlPreview, renderFooter()) : React.createElement(View, null, renderMedia(), React.createElement(Text, {\n    style: (propsContext === null || propsContext === void 0 ? void 0 : (_propsContext$bubbleP52 = propsContext.bubbleProps) === null || _propsContext$bubbleP52 === void 0 ? void 0 : _propsContext$bubbleP52.labelStyle) && ((_propsContext$bubbleP53 = propsContext.bubbleProps) === null || _propsContext$bubbleP53 === void 0 ? void 0 : _propsContext$bubbleP53.labelStyle((_message$me3 = message === null || message === void 0 ? void 0 : message.me) !== null && _message$me3 !== void 0 ? _message$me3 : false))\n  }, message === null || message === void 0 ? void 0 : message.text), renderUrlPreview, renderFooter())), renderCornerRounding())), ((_propsContext$bubbleP54 = propsContext.bubbleProps) === null || _propsContext$bubbleP54 === void 0 ? void 0 : (_propsContext$bubbleP55 = _propsContext$bubbleP54.showAvatars) === null || _propsContext$bubbleP55 === void 0 ? void 0 : _propsContext$bubbleP55.visible) && (message === null || message === void 0 ? void 0 : message.me) && React.createElement(Image, {\n    source: (_message$user$avatar2 = message === null || message === void 0 ? void 0 : message.user.avatar) !== null && _message$user$avatar2 !== void 0 ? _message$user$avatar2 : require(\"./assets/images/noavatar.png\"),\n    style: [styles.avatarMe, avatarSize]\n  }), ((_propsContext$bubbleP56 = propsContext.bubbleProps) === null || _propsContext$bubbleP56 === void 0 ? void 0 : _propsContext$bubbleP56.trailingAccessory) && !(message !== null && message !== void 0 && message.me) && React.createElement(View, null, propsContext.bubbleProps.trailingAccessory));\n}\n\nexport var ChatBubble = React.memo(_ChatBubble);\nexport var styles = StyleSheet.create({\n  wrapper: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between'\n  },\n  container: {\n    margin: 20,\n    maxWidth: Dimensions.get('screen').width - 120,\n    borderRadius: 10\n  },\n  rightArrow: {\n    position: 'absolute',\n    width: 20,\n    height: 25,\n    bottom: 0,\n    borderBottomLeftRadius: 25,\n    right: -7\n  },\n  rightArrowOverlap: {\n    position: 'absolute',\n    width: 20,\n    height: 35,\n    bottom: -6,\n    borderBottomLeftRadius: 18,\n    right: -20\n  },\n  leftArrow: {\n    position: 'absolute',\n    width: 20,\n    height: 25,\n    bottom: 0,\n    borderBottomRightRadius: 25,\n    left: -10\n  },\n  leftArrowOverlap: {\n    position: 'absolute',\n    width: 20,\n    height: 35,\n    bottom: -6,\n    borderBottomRightRadius: 18,\n    left: -20\n  },\n  date: {\n    color: '#a8a8a8',\n    fontSize: 11\n  },\n  avatar: {\n    marginLeft: 10\n  },\n  avatarMe: {\n    marginRight: 10\n  },\n  bubbleFooter: {\n    justifyContent: 'flex-end',\n    flexDirection: 'row',\n    marginTop: 5\n  },\n  moreMedia: {\n    width: 100,\n    height: 100,\n    borderWidth: 1,\n    borderStyle: 'dashed',\n    borderRadius: 15,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderColor: '#ccc'\n  },\n  media: {\n    width: 110,\n    height: 100,\n    borderRadius: 15,\n    marginRight: 10,\n    marginBottom: 10\n  },\n  backgroundOverlay: {\n    width: 110,\n    height: 100,\n    backgroundColor: 'rgba(0,0,0,0.6)',\n    borderRadius: 15,\n    justifyContent: 'center',\n    alignContent: 'center',\n    alignItems: 'center'\n  }\n});","map":{"version":3,"sources":["ChatBubble.tsx"],"names":["ParsedText","loadParsedText","children","propsContext","useContext","useState","createdAt","useMemo","message","dayjs","avatarSize","width","height","borderRadius","bubbleBackgroundColor","backgroundColor","containerStyle","bubbleAlignment","alignSelf","useEffect","media","MediaType","InteractionManager","Image","setMediaLoaded","url","extractUrlFromString","data","fetchMetaData","setShowUrlPreview","setUrlPreviewData","onPressPattern","useCallback","ChatEmitter","messagePatterns","patterns","LoadAllPaternShapes","pattern","ALL_PATERNS_SHAPES","renderTicks","MessageStatus","renderFooter","styles","bubbleFooter","renderCornerRounding","renderMedia","flexDirection","flexWrap","index","setShowMedia","mediaLoaded","uri","backgroundOverlay","color","textAlign","fontSize","PhotoView","renderUrlPreview","showUrlPreview","marginTop","urlPreviewData","require","padding","id","ChatBubble","React","wrapper","alignItems","justifyContent","container","margin","maxWidth","Dimensions","rightArrow","position","bottom","borderBottomLeftRadius","right","rightArrowOverlap","leftArrow","borderBottomRightRadius","left","leftArrowOverlap","date","avatar","marginLeft","avatarMe","marginRight","moreMedia","borderWidth","borderStyle","borderColor","marginBottom","alignContent"],"mappings":"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","sourcesContent":["import dayjs from 'dayjs';\nimport React, {\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport {\n  Dimensions,\n  Image,\n  ImageBackground,\n  InteractionManager,\n  StyleSheet,\n  Text,\n  TouchableOpacity,\n  View,\n  ViewStyle,\n} from 'react-native';\nimport { PropsContext } from './Chatty';\nimport { ReplyingTo } from './components/ReplyingTo';\nimport { UrlPreviewBubble } from './components/UrlPreviewBubble';\nimport {\n  IChatBubble,\n  IMessage,\n  IUrlPreviewBubble,\n  MediaType,\n  MessageStatus,\n} from './types/Chatty.types';\nimport { ChatEmitter } from './utils/eventEmitter';\nimport { extractUrlFromString, fetchMetaData } from './utils/helpers';\nimport { Skeleton } from './utils/moti';\nimport {\n  ALL_PATERNS_SHAPES,\n  HASHTAG_PATTERN_SHAPE,\n  LoadAllPaternShapes,\n  loadParsedText,\n  MENTION_PATTERN_SHAPE,\n  URL_PATTERN_SHAPE,\n} from './utils/patterns';\nimport { PhotoView } from './utils/photoView';\nimport { ContextMenuWrapper } from './wrappers/ContextMenuWrapper';\n\nconst ParsedText = loadParsedText();\n\nfunction _ChatBubble(props: IChatBubble) {\n  const { message, children } = props;\n  const propsContext = useContext(PropsContext);\n  const [mediaLoaded, setMediaLoaded] = useState<boolean>(false);\n  const [showMedia, setShowMedia] = useState<boolean>(false);\n  const [showUrlPreview, setShowUrlPreview] = useState(false);\n  const [urlPreviewData, setUrlPreviewData] = useState<IUrlPreviewBubble>();\n  const createdAt = useMemo(() => {\n    return message && dayjs(message.createdAt).format('HH:mm');\n  }, [message]);\n\n  const avatarSize = useMemo(() => {\n    return {\n      width: propsContext.bubbleProps?.showAvatars?.width || 40,\n      height: propsContext.bubbleProps?.showAvatars?.width || 40,\n      borderRadius: propsContext.bubbleProps?.showAvatars?.width || 40,\n    };\n  }, [propsContext.bubbleProps?.showAvatars?.width]);\n\n  const bubbleBackgroundColor = useMemo<ViewStyle>(() => {\n    if (propsContext.bubbleProps?.containerStyle) {\n      if (message?.me) {\n        return {\n          backgroundColor:\n            propsContext?.bubbleProps?.selfBubbleColor ?? '#afddfa',\n          ...propsContext.bubbleProps.containerStyle,\n        };\n      } else {\n        return {\n          backgroundColor:\n            propsContext?.bubbleProps?.otherBubbleColor ?? '#c8faaf',\n\n          ...propsContext.bubbleProps.containerStyle,\n        };\n      }\n    }\n\n    if (message?.me) {\n      return {\n        backgroundColor:\n          propsContext?.bubbleProps?.selfBubbleColor ?? '#afddfa',\n      };\n    }\n\n    return {\n      backgroundColor: propsContext?.bubbleProps?.otherBubbleColor ?? '#c8faaf',\n    };\n  }, [\n    message?.me,\n    propsContext?.bubbleProps?.otherBubbleColor,\n    propsContext?.bubbleProps?.selfBubbleColor,\n    propsContext.bubbleProps?.containerStyle,\n  ]);\n\n  const bubbleAlignment = useMemo<ViewStyle>(() => {\n    if (message?.me) {\n      return {\n        alignSelf: 'flex-end',\n      };\n    }\n\n    return {\n      alignSelf: 'flex-start',\n    };\n  }, [message?.me]);\n\n  useEffect(() => {\n    if (message?.media) {\n      message.media.forEach((media) => {\n        if (media.type === MediaType.Image) {\n          InteractionManager.runAfterInteractions(() => {\n            Image.prefetch(media.uri).then(() => {\n              setMediaLoaded(true);\n            });\n          });\n        }\n      });\n    }\n\n    if (propsContext.enableUrlPreviews) {\n      InteractionManager.runAfterInteractions(async () => {\n        const url = extractUrlFromString(message?.text ?? '');\n\n        if (url) {\n          const data = await fetchMetaData(url);\n\n          if (data) {\n            setShowUrlPreview(true);\n            setUrlPreviewData(data);\n          }\n        }\n      });\n    }\n  }, [message?.media, message?.text, propsContext.enableUrlPreviews]);\n\n  const onPressPattern = useCallback(\n    (pattern: string, index: number) => {\n      if (!message) return;\n      ChatEmitter?.emit('patternPressed', pattern, index, message);\n    },\n    [message]\n  );\n\n  const messagePatterns = useMemo(() => {\n    const patterns: any[] = [];\n\n    if (!propsContext?.enablePatterns) return;\n    if (!ParsedText) return;\n\n    LoadAllPaternShapes(onPressPattern);\n\n    if (propsContext.patternProps?.customPatterns) {\n      patterns.push(...propsContext.patternProps.customPatterns);\n    }\n\n    if (propsContext?.patternProps?.allowPatterns) {\n      propsContext.patternProps.allowPatterns.forEach((pattern) => {\n        switch (pattern) {\n          case 'hashtag':\n            patterns.push(HASHTAG_PATTERN_SHAPE);\n            break;\n          case 'mention':\n            patterns.push(MENTION_PATTERN_SHAPE);\n            break;\n          case 'url':\n            patterns.push(URL_PATTERN_SHAPE);\n            break;\n        }\n      });\n    } else {\n      ALL_PATERNS_SHAPES.forEach((pattern) => patterns.push(pattern));\n    }\n\n    return patterns;\n  }, [\n    onPressPattern,\n    propsContext?.enablePatterns,\n    propsContext?.patternProps?.allowPatterns,\n    propsContext?.patternProps?.customPatterns,\n  ]);\n\n  const renderTicks = useCallback(() => {\n    if (message?.status) {\n      switch (message.status) {\n        case MessageStatus.Sending:\n          return (\n            propsContext.bubbleProps?.tickProps?.sendingElement ?? (\n              <Text>🔄</Text>\n            )\n          );\n\n        case MessageStatus.Sent:\n          return (\n            propsContext.bubbleProps?.tickProps?.sentElement ?? <Text>✔</Text>\n          );\n\n        case MessageStatus.Delivered:\n          return (\n            propsContext.bubbleProps?.tickProps?.deliveredElement ?? (\n              <Text>☑</Text>\n            )\n          );\n\n        case MessageStatus.Read:\n          return (\n            propsContext.bubbleProps?.tickProps?.readElement ?? <Text>✅</Text>\n          );\n      }\n    }\n\n    return null;\n  }, [\n    message?.status,\n    propsContext.bubbleProps?.tickProps?.deliveredElement,\n    propsContext.bubbleProps?.tickProps?.readElement,\n    propsContext.bubbleProps?.tickProps?.sendingElement,\n    propsContext.bubbleProps?.tickProps?.sentElement,\n  ]);\n\n  const renderFooter = useCallback(() => {\n    return (\n      <View style={styles.bubbleFooter}>\n        <Text\n          style={[\n            styles.date,\n            propsContext?.bubbleProps?.dateStyle &&\n              propsContext?.bubbleProps?.dateStyle!(message?.me ?? false),\n          ]}\n        >\n          {createdAt}\n        </Text>\n        {renderTicks()}\n      </View>\n    );\n  }, [\n    createdAt,\n    message?.me,\n    propsContext?.bubbleProps?.dateStyle,\n    renderTicks,\n  ]);\n\n  const renderCornerRounding = useCallback(() => {\n    if (propsContext.bubbleProps?.enableCornerRounding === false) return null;\n\n    if (message?.me) {\n      return (\n        <>\n          <View style={[styles.rightArrow, bubbleBackgroundColor]}></View>\n          <View\n            style={[\n              styles.rightArrowOverlap,\n              {\n                backgroundColor:\n                  propsContext.listProps?.containerStyle?.backgroundColor ??\n                  '#fff',\n              },\n            ]}\n          ></View>\n        </>\n      );\n    } else {\n      return (\n        <>\n          <View style={[styles.leftArrow, bubbleBackgroundColor]}></View>\n          <View\n            style={[\n              styles.leftArrowOverlap,\n              {\n                backgroundColor:\n                  propsContext.listProps?.containerStyle?.backgroundColor ??\n                  '#fff',\n              },\n            ]}\n          ></View>\n        </>\n      );\n    }\n  }, [\n    bubbleBackgroundColor,\n    message?.me,\n    propsContext.bubbleProps?.enableCornerRounding,\n    propsContext.listProps?.containerStyle?.backgroundColor,\n  ]);\n\n  const renderMedia = useCallback(() => {\n    if (message?.media) {\n      return (\n        <View style={{ flexDirection: 'row', flexWrap: 'wrap' }}>\n          {message?.media.map((media, index) => {\n            if (index < 3) {\n              return (\n                <TouchableOpacity onPress={() => setShowMedia(true)}>\n                  {media.type === MediaType.Image && (\n                    <Skeleton show={!mediaLoaded}>\n                      <Image source={{ uri: media.uri }} style={styles.media} />\n                    </Skeleton>\n                  )}\n                </TouchableOpacity>\n              );\n            }\n\n            return null;\n          })}\n\n          {message.media.length > 3 && (\n            <TouchableOpacity onPress={() => setShowMedia(true)}>\n              <ImageBackground\n                style={styles.media}\n                source={{ uri: message.media[3]?.uri }}\n                imageStyle={{\n                  borderRadius: 15,\n                }}\n              >\n                <View style={styles.backgroundOverlay}>\n                  <Text\n                    style={{ color: '#fff', textAlign: 'center', fontSize: 20 }}\n                  >\n                    + {message.media.length - 3}\n                  </Text>\n                </View>\n              </ImageBackground>\n            </TouchableOpacity>\n          )}\n\n          {PhotoView && (\n            <PhotoView\n              images={message?.media}\n              imageIndex={0}\n              visible={showMedia}\n              onRequestClose={() => setShowMedia(false)}\n            />\n          )}\n        </View>\n      );\n    }\n\n    return null;\n  }, [mediaLoaded, message, showMedia]);\n\n  const renderUrlPreview = useMemo(() => {\n    if (showUrlPreview && urlPreviewData && !message?.repliedTo) {\n      return (\n        <View style={{ marginTop: 10 }}>\n          <UrlPreviewBubble\n            title={urlPreviewData.title}\n            description={urlPreviewData.description}\n            image={urlPreviewData.image}\n            url={urlPreviewData.url}\n          />\n        </View>\n      );\n    }\n\n    return null;\n  }, [message?.repliedTo, showUrlPreview, urlPreviewData]);\n\n  return (\n    <View style={[styles.wrapper, bubbleAlignment]}>\n      {propsContext.bubbleProps?.trailingAccessory && message?.me && (\n        <View>{propsContext.bubbleProps.trailingAccessory}</View>\n      )}\n\n      {propsContext.bubbleProps?.showAvatars?.visible && !message?.me && (\n        <Image\n          source={\n            message?.user.avatar ?? require('./assets/images/noavatar.png')\n          }\n          style={[styles.avatar, avatarSize]}\n        />\n      )}\n\n      <ContextMenuWrapper message={message as IMessage}>\n        <View\n          style={[\n            bubbleBackgroundColor,\n            styles.container,\n            propsContext.bubbleProps?.containerStyle,\n            { padding: message?.repliedTo ? 5 : 15 },\n          ]}\n        >\n          {children ? (\n            children\n          ) : (\n            <>\n              {message?.repliedTo && (\n                <ReplyingTo\n                  username={message?.repliedTo?.user.username}\n                  text={message?.repliedTo.text}\n                  messageId={message?.repliedTo.id}\n                />\n              )}\n\n              {propsContext?.enablePatterns && ParsedText ? (\n                <>\n                  {renderMedia()}\n\n                  <ParsedText\n                    parse={messagePatterns}\n                    style={\n                      propsContext?.bubbleProps?.labelStyle &&\n                      propsContext.bubbleProps?.labelStyle(message?.me ?? false)\n                    }\n                  >\n                    {message?.text}\n                  </ParsedText>\n                  {renderUrlPreview}\n                  {renderFooter()}\n                </>\n              ) : (\n                <View>\n                  {renderMedia()}\n\n                  <Text\n                    style={\n                      propsContext?.bubbleProps?.labelStyle &&\n                      propsContext.bubbleProps?.labelStyle(message?.me ?? false)\n                    }\n                  >\n                    {message?.text}\n                  </Text>\n                  {renderUrlPreview}\n                  {renderFooter()}\n                </View>\n              )}\n            </>\n          )}\n          {renderCornerRounding()}\n        </View>\n      </ContextMenuWrapper>\n\n      {propsContext.bubbleProps?.showAvatars?.visible && message?.me && (\n        <Image\n          source={\n            message?.user.avatar ?? require('./assets/images/noavatar.png')\n          }\n          style={[styles.avatarMe, avatarSize]}\n        />\n      )}\n\n      {propsContext.bubbleProps?.trailingAccessory && !message?.me && (\n        <View>{propsContext.bubbleProps.trailingAccessory}</View>\n      )}\n    </View>\n  );\n}\n\nexport const ChatBubble = React.memo(_ChatBubble);\n\nexport const styles = StyleSheet.create({\n  wrapper: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  container: {\n    margin: 20,\n    maxWidth: Dimensions.get('screen').width - 120,\n    borderRadius: 10,\n  },\n  rightArrow: {\n    position: 'absolute',\n    width: 20,\n    height: 25,\n    bottom: 0,\n    borderBottomLeftRadius: 25,\n    right: -7,\n  },\n  rightArrowOverlap: {\n    position: 'absolute',\n    width: 20,\n    height: 35,\n    bottom: -6,\n    borderBottomLeftRadius: 18,\n    right: -20,\n  },\n  leftArrow: {\n    position: 'absolute',\n    width: 20,\n    height: 25,\n    bottom: 0,\n    borderBottomRightRadius: 25,\n    left: -10,\n  },\n\n  leftArrowOverlap: {\n    position: 'absolute',\n    width: 20,\n    height: 35,\n    bottom: -6,\n    borderBottomRightRadius: 18,\n    left: -20,\n  },\n  date: {\n    color: '#a8a8a8',\n    fontSize: 11,\n  },\n  avatar: {\n    marginLeft: 10,\n  },\n  avatarMe: {\n    marginRight: 10,\n  },\n  bubbleFooter: {\n    justifyContent: 'flex-end',\n    flexDirection: 'row',\n    marginTop: 5,\n  },\n  moreMedia: {\n    width: 100,\n    height: 100,\n    borderWidth: 1,\n    borderStyle: 'dashed',\n    borderRadius: 15,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderColor: '#ccc',\n  },\n  media: {\n    width: 110,\n    height: 100,\n    borderRadius: 15,\n    marginRight: 10,\n    marginBottom: 10,\n  },\n  backgroundOverlay: {\n    width: 110,\n    height: 100,\n    backgroundColor: 'rgba(0,0,0,0.6)',\n    borderRadius: 15,\n    justifyContent: 'center',\n    alignContent: 'center',\n    alignItems: 'center',\n  },\n});\n"]},"metadata":{},"sourceType":"module"}