{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport React, { useContext } from 'react';\nimport { useCallback } from 'react';\nimport { ActionSheetIOS } from \"react-native-web/dist/index\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { PropsContext } from \"../Chatty\";\nimport { contextMenuView } from \"../utils/contextMenu\";\nimport { ChatEmitter } from \"../utils/eventEmitter\";\n\nfunction ContextMenuWrapper(props) {\n  var _propsContext$bubbleP10, _propsContext$bubbleP11, _propsContext$bubbleP12, _propsContext$bubbleP13, _propsContext$bubbleP14, _propsContext$bubbleP17, _propsContext$bubbleP18;\n\n  var propsContext = useContext(PropsContext);\n\n  var _onPress = useCallback(function (index) {\n    ChatEmitter.emit('actionPressed', index, props.message);\n  }, [props.message]);\n\n  var onLongPress = useCallback(function () {\n    if (Platform.OS === 'ios') {\n      var _propsContext$bubbleP, _propsContext$bubbleP2, _propsContext$bubbleP3, _propsContext$bubbleP4, _propsContext$bubbleP5, _propsContext$bubbleP6, _propsContext$bubbleP7, _propsContext$bubbleP8, _propsContext$bubbleP9;\n\n      ActionSheetIOS.showActionSheetWithOptions({\n        options: [].concat(_toConsumableArray((_propsContext$bubbleP = propsContext.bubbleProps) === null || _propsContext$bubbleP === void 0 ? void 0 : (_propsContext$bubbleP2 = _propsContext$bubbleP.actions) === null || _propsContext$bubbleP2 === void 0 ? void 0 : _propsContext$bubbleP2.options.map(function (_) {\n          return _.title;\n        })), [(_propsContext$bubbleP3 = (_propsContext$bubbleP4 = propsContext.bubbleProps) === null || _propsContext$bubbleP4 === void 0 ? void 0 : (_propsContext$bubbleP5 = _propsContext$bubbleP4.actions) === null || _propsContext$bubbleP5 === void 0 ? void 0 : _propsContext$bubbleP5.cancelButtonLabel) !== null && _propsContext$bubbleP3 !== void 0 ? _propsContext$bubbleP3 : 'Close']),\n        cancelButtonIndex: (_propsContext$bubbleP6 = propsContext.bubbleProps) === null || _propsContext$bubbleP6 === void 0 ? void 0 : (_propsContext$bubbleP7 = _propsContext$bubbleP6.actions) === null || _propsContext$bubbleP7 === void 0 ? void 0 : _propsContext$bubbleP7.options.length,\n        destructiveButtonIndex: ((_propsContext$bubbleP8 = propsContext.bubbleProps) === null || _propsContext$bubbleP8 === void 0 ? void 0 : (_propsContext$bubbleP9 = _propsContext$bubbleP8.actions) === null || _propsContext$bubbleP9 === void 0 ? void 0 : _propsContext$bubbleP9.options.findIndex(function (_) {\n          return _.destructive;\n        })) || -1\n      }, _onPress);\n    }\n  }, [_onPress, (_propsContext$bubbleP10 = propsContext.bubbleProps) === null || _propsContext$bubbleP10 === void 0 ? void 0 : (_propsContext$bubbleP11 = _propsContext$bubbleP10.actions) === null || _propsContext$bubbleP11 === void 0 ? void 0 : _propsContext$bubbleP11.cancelButtonLabel, (_propsContext$bubbleP12 = propsContext.bubbleProps) === null || _propsContext$bubbleP12 === void 0 ? void 0 : (_propsContext$bubbleP13 = _propsContext$bubbleP12.actions) === null || _propsContext$bubbleP13 === void 0 ? void 0 : _propsContext$bubbleP13.options]);\n  if (!((_propsContext$bubbleP14 = propsContext.bubbleProps) !== null && _propsContext$bubbleP14 !== void 0 && _propsContext$bubbleP14.actions)) return props.children;\n\n  if (!contextMenuView) {\n    return React.createElement(TouchableOpacity, {\n      onLongPress: onLongPress\n    }, props.children);\n  }\n\n  if (Platform.OS === 'ios' && Platform.Version >= 13) {\n    var _propsContext$bubbleP15, _propsContext$bubbleP16;\n\n    return React.createElement(contextMenuView.default, {\n      actions: (_propsContext$bubbleP15 = propsContext.bubbleProps) === null || _propsContext$bubbleP15 === void 0 ? void 0 : (_propsContext$bubbleP16 = _propsContext$bubbleP15.actions) === null || _propsContext$bubbleP16 === void 0 ? void 0 : _propsContext$bubbleP16.options,\n      onPress: function onPress(e) {\n        return _onPress(e.nativeEvent.index);\n      }\n    }, props.children);\n  }\n\n  return React.createElement(contextMenuView.default, {\n    actions: (_propsContext$bubbleP17 = propsContext.bubbleProps) === null || _propsContext$bubbleP17 === void 0 ? void 0 : (_propsContext$bubbleP18 = _propsContext$bubbleP17.actions) === null || _propsContext$bubbleP18 === void 0 ? void 0 : _propsContext$bubbleP18.options,\n    onPress: function onPress(e) {\n      return _onPress(e.nativeEvent.index);\n    }\n  }, props.children);\n}\n\nexport { ContextMenuWrapper };","map":{"version":3,"mappings":";AAAA,OAAOA,KAAP,IAAgBC,UAAhB,QAAkC,OAAlC;AACA,SAASC,WAAT,QAA4B,OAA5B;SACSC,c;;;AAET,SAASC,YAAT;AACA,SAASC,eAAT;AACA,SAASC,WAAT;;AAOA,SAASC,kBAAT,CAA4BC,KAA5B,EAA2C;EAAA;;EACzC,IAAMC,YAAY,GAAGR,UAAU,CAACG,YAAD,CAA/B;;EAEA,IAAMM,QAAO,GAAGR,WAAW,CACxBS,eAAD,EAAW;IACTL,WAAW,CAACM,IAAZN,CAAiB,eAAjBA,EAAkCK,KAAlCL,EAAyCE,KAAK,CAACK,OAA/CP;EAFuB,GAIzB,CAACE,KAAK,CAACK,OAAP,CAJyB,CAA3B;;EAOA,IAAMC,WAAW,GAAGZ,WAAW,CAAC,YAAM;IACpC,IAAIa,QAAQ,CAACC,EAATD,KAAgB,KAApB,EAA2B;MAAA;;MACzBZ,cAAc,CAACc,0BAAfd,CACE;QACEe,OAAO,+BACL,yBAAIT,YAAY,CAACU,WAAjB,oFAAIC,sBAA0BC,OAA9B,2DAAIC,uBAAmCJ,OAAnC,CAA2CK,GAA3C,CACDC,WAAD;UAAA,OAAOA,CAAC,CAACC,KAAT;QAAA,CADE,CADC,IAAE,oDAIPhB,YAAY,CAACU,WAJN,qFAIPO,uBAA0BL,OAJnB,2DAIPM,uBAAmCC,iBAJ5B,2EAIiD,OAJnD,EADT;QAOEC,iBAAiB,4BAAEpB,YAAY,CAACU,WAAf,qFAAEW,uBAA0BT,OAA5B,2DAAEU,uBAAmCb,OAAnC,CAA2Cc,MAPhE;QAQEC,sBAAsB,EACpB,uCAAY,CAACd,WAAb,4GAA0BE,OAA1B,kFAAmCH,OAAnC,CAA2CgB,SAA3C,CACGV,WAAD;UAAA,OAAOA,CAAC,CAACW,WAAT;QAAA,CADF,MAEK,CAAC;MAXV,CADFhC,EAcEO,QAdFP;IAgBD;EAlB4B,GAmB5B,CACDO,QADC,6BAEDD,YAAY,CAACU,WAFZ,uFAEDiB,wBAA0Bf,OAFzB,4DAEDgB,wBAAmCT,iBAFlC,6BAGDnB,YAAY,CAACU,WAHZ,uFAGDmB,wBAA0BjB,OAHzB,4DAGDkB,wBAAmCrB,OAHlC,CAnB4B,CAA/B;EA0BA,IAAI,6BAACT,YAAY,CAACU,WAAd,oDAACqB,wBAA0BnB,OAA3B,CAAJ,EAAwC,OAAOb,KAAK,CAACiC,QAAb;;EAGxC,IAAI,CAACpC,eAAL,EAAsB;IACpB,OACEL,oBAAC0C,gBAAD;MAAkB5B,WAAW,EAAEA;IAA/B,GACGN,KAAK,CAACiC,QADT,CADF;EAKD;;EAED,IAAI1B,QAAQ,CAACC,EAATD,KAAgB,KAAhBA,IAAyBA,QAAQ,CAAC4B,OAAT5B,IAAoB,EAAjD,EAAqD;IAAA;;IACnD,OACEf,oBAACK,eAAD,CAAiBuC,OAAjB;MACEvB,OAAO,6BAAEZ,YAAY,CAACU,WAAf,uFAAE0B,wBAA0BxB,OAA5B,4DAAEyB,wBAAmC5B,OAD9C;MAEER,OAAO,EAAGqC,kBAAD;QAAA,OAAYrC,QAAO,CAACqC,CAAC,CAACC,WAAFD,CAAcpC,KAAf,CAAnB;MAAA;IAFX,GAIGH,KAAK,CAACiC,QAJT,CADF;EAQD;;EACD,OACEzC,oBAACK,eAAD,CAAiBuC,OAAjB;IACEvB,OAAO,6BAAEZ,YAAY,CAACU,WAAf,uFAAE8B,wBAA0B5B,OAA5B,4DAAE6B,wBAAmChC,OAD9C;IAEER,OAAO,EAAGqC,kBAAD;MAAA,OAAYrC,QAAO,CAACqC,CAAC,CAACC,WAAFD,CAAcpC,KAAf,CAAnB;IAAA;EAFX,GAIGH,KAAK,CAACiC,QAJT,CADF;AAQD;;AAED,SAASlC,kBAAT","names":["React","useContext","useCallback","ActionSheetIOS","PropsContext","contextMenuView","ChatEmitter","ContextMenuWrapper","props","propsContext","onPress","index","emit","message","onLongPress","Platform","OS","showActionSheetWithOptions","options","bubbleProps","_propsContext$bubbleP","actions","_propsContext$bubbleP2","map","_","title","_propsContext$bubbleP4","_propsContext$bubbleP5","cancelButtonLabel","cancelButtonIndex","_propsContext$bubbleP6","_propsContext$bubbleP7","length","destructiveButtonIndex","findIndex","destructive","_propsContext$bubbleP10","_propsContext$bubbleP11","_propsContext$bubbleP12","_propsContext$bubbleP13","_propsContext$bubbleP14","children","TouchableOpacity","Version","default","_propsContext$bubbleP15","_propsContext$bubbleP16","e","nativeEvent","_propsContext$bubbleP17","_propsContext$bubbleP18"],"sources":["ContextMenuWrapper.tsx"],"sourcesContent":["import React, { useContext } from 'react';\nimport { useCallback } from 'react';\nimport { ActionSheetIOS, Platform, TouchableOpacity } from 'react-native';\nimport type { IMessage } from '../types/Chatty.types';\nimport { PropsContext } from '../Chatty';\nimport { contextMenuView } from '../utils/contextMenu';\nimport { ChatEmitter } from '../utils/eventEmitter';\n\ninterface IProps {\n  message: IMessage;\n  children: JSX.Element;\n}\n\nfunction ContextMenuWrapper(props: IProps) {\n  const propsContext = useContext(PropsContext);\n\n  const onPress = useCallback(\n    (index) => {\n      ChatEmitter.emit('actionPressed', index, props.message);\n    },\n    [props.message]\n  );\n\n  const onLongPress = useCallback(() => {\n    if (Platform.OS === 'ios') {\n      ActionSheetIOS.showActionSheetWithOptions(\n        {\n          options: [\n            ...(propsContext.bubbleProps?.actions?.options.map(\n              (_) => _.title\n            ) as string[]),\n            propsContext.bubbleProps?.actions?.cancelButtonLabel ?? 'Close',\n          ],\n          cancelButtonIndex: propsContext.bubbleProps?.actions?.options.length,\n          destructiveButtonIndex:\n            propsContext.bubbleProps?.actions?.options.findIndex(\n              (_) => _.destructive\n            ) || -1,\n        },\n        onPress\n      );\n    }\n  }, [\n    onPress,\n    propsContext.bubbleProps?.actions?.cancelButtonLabel,\n    propsContext.bubbleProps?.actions?.options,\n  ]);\n\n  // If actions are not defined, just return the children\n  if (!propsContext.bubbleProps?.actions) return props.children;\n\n  // If actions are defined, but ios version is not supported, return the actionsheet\n  if (!contextMenuView) {\n    return (\n      <TouchableOpacity onLongPress={onLongPress}>\n        {props.children}\n      </TouchableOpacity>\n    );\n  }\n\n  if (Platform.OS === 'ios' && Platform.Version >= 13) {\n    return (\n      <contextMenuView.default\n        actions={propsContext.bubbleProps?.actions?.options}\n        onPress={(e: any) => onPress(e.nativeEvent.index)}\n      >\n        {props.children}\n      </contextMenuView.default>\n    );\n  }\n  return (\n    <contextMenuView.default\n      actions={propsContext.bubbleProps?.actions?.options}\n      onPress={(e: any) => onPress(e.nativeEvent.index)}\n    >\n      {props.children}\n    </contextMenuView.default>\n  );\n}\n\nexport { ContextMenuWrapper };\n"]},"metadata":{},"sourceType":"module"}