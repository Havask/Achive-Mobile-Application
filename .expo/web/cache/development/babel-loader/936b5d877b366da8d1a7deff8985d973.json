{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport React, { useContext } from 'react';\nimport { useCallback } from 'react';\nimport { ActionSheetIOS } from \"react-native-web/dist/index\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { PropsContext } from \"../Chatty\";\nimport { contextMenuView } from \"../utils/contextMenu\";\nimport { ChatEmitter } from \"../utils/eventEmitter\";\n\nfunction ContextMenuWrapper(props) {\n  var _propsContext$bubbleP10, _propsContext$bubbleP11, _propsContext$bubbleP12, _propsContext$bubbleP13, _propsContext$bubbleP14, _propsContext$bubbleP17, _propsContext$bubbleP18;\n\n  var propsContext = useContext(PropsContext);\n\n  var _onPress = useCallback(function (index) {\n    ChatEmitter.emit('actionPressed', index, props.message);\n  }, [props.message]);\n\n  var onLongPress = useCallback(function () {\n    if (Platform.OS === 'ios') {\n      var _propsContext$bubbleP, _propsContext$bubbleP2, _propsContext$bubbleP3, _propsContext$bubbleP4, _propsContext$bubbleP5, _propsContext$bubbleP6, _propsContext$bubbleP7, _propsContext$bubbleP8, _propsContext$bubbleP9;\n\n      ActionSheetIOS.showActionSheetWithOptions({\n        options: [].concat(_toConsumableArray((_propsContext$bubbleP = propsContext.bubbleProps) === null || _propsContext$bubbleP === void 0 ? void 0 : (_propsContext$bubbleP2 = _propsContext$bubbleP.actions) === null || _propsContext$bubbleP2 === void 0 ? void 0 : _propsContext$bubbleP2.options.map(function (_) {\n          return _.title;\n        })), [(_propsContext$bubbleP3 = (_propsContext$bubbleP4 = propsContext.bubbleProps) === null || _propsContext$bubbleP4 === void 0 ? void 0 : (_propsContext$bubbleP5 = _propsContext$bubbleP4.actions) === null || _propsContext$bubbleP5 === void 0 ? void 0 : _propsContext$bubbleP5.cancelButtonLabel) !== null && _propsContext$bubbleP3 !== void 0 ? _propsContext$bubbleP3 : 'Close']),\n        cancelButtonIndex: (_propsContext$bubbleP6 = propsContext.bubbleProps) === null || _propsContext$bubbleP6 === void 0 ? void 0 : (_propsContext$bubbleP7 = _propsContext$bubbleP6.actions) === null || _propsContext$bubbleP7 === void 0 ? void 0 : _propsContext$bubbleP7.options.length,\n        destructiveButtonIndex: ((_propsContext$bubbleP8 = propsContext.bubbleProps) === null || _propsContext$bubbleP8 === void 0 ? void 0 : (_propsContext$bubbleP9 = _propsContext$bubbleP8.actions) === null || _propsContext$bubbleP9 === void 0 ? void 0 : _propsContext$bubbleP9.options.findIndex(function (_) {\n          return _.destructive;\n        })) || -1\n      }, _onPress);\n    }\n  }, [_onPress, (_propsContext$bubbleP10 = propsContext.bubbleProps) === null || _propsContext$bubbleP10 === void 0 ? void 0 : (_propsContext$bubbleP11 = _propsContext$bubbleP10.actions) === null || _propsContext$bubbleP11 === void 0 ? void 0 : _propsContext$bubbleP11.cancelButtonLabel, (_propsContext$bubbleP12 = propsContext.bubbleProps) === null || _propsContext$bubbleP12 === void 0 ? void 0 : (_propsContext$bubbleP13 = _propsContext$bubbleP12.actions) === null || _propsContext$bubbleP13 === void 0 ? void 0 : _propsContext$bubbleP13.options]);\n  if (!((_propsContext$bubbleP14 = propsContext.bubbleProps) !== null && _propsContext$bubbleP14 !== void 0 && _propsContext$bubbleP14.actions)) return props.children;\n\n  if (!contextMenuView) {\n    return React.createElement(TouchableOpacity, {\n      onLongPress: onLongPress\n    }, props.children);\n  }\n\n  if (Platform.OS === 'ios' && Platform.Version >= 13) {\n    var _propsContext$bubbleP15, _propsContext$bubbleP16;\n\n    return React.createElement(contextMenuView.default, {\n      actions: (_propsContext$bubbleP15 = propsContext.bubbleProps) === null || _propsContext$bubbleP15 === void 0 ? void 0 : (_propsContext$bubbleP16 = _propsContext$bubbleP15.actions) === null || _propsContext$bubbleP16 === void 0 ? void 0 : _propsContext$bubbleP16.options,\n      onPress: function onPress(e) {\n        return _onPress(e.nativeEvent.index);\n      }\n    }, props.children);\n  }\n\n  return React.createElement(contextMenuView.default, {\n    actions: (_propsContext$bubbleP17 = propsContext.bubbleProps) === null || _propsContext$bubbleP17 === void 0 ? void 0 : (_propsContext$bubbleP18 = _propsContext$bubbleP17.actions) === null || _propsContext$bubbleP18 === void 0 ? void 0 : _propsContext$bubbleP18.options,\n    onPress: function onPress(e) {\n      return _onPress(e.nativeEvent.index);\n    }\n  }, props.children);\n}\n\nexport { ContextMenuWrapper };","map":{"version":3,"sources":["ContextMenuWrapper.tsx"],"names":["propsContext","useContext","onPress","useCallback","index","ChatEmitter","props","onLongPress","Platform","ActionSheetIOS","options","_","cancelButtonIndex","destructiveButtonIndex","e"],"mappings":"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","sourcesContent":["import React, { useContext } from 'react';\nimport { useCallback } from 'react';\nimport { ActionSheetIOS, Platform, TouchableOpacity } from 'react-native';\nimport type { IMessage } from '../types/Chatty.types';\nimport { PropsContext } from '../Chatty';\nimport { contextMenuView } from '../utils/contextMenu';\nimport { ChatEmitter } from '../utils/eventEmitter';\n\ninterface IProps {\n  message: IMessage;\n  children: JSX.Element;\n}\n\nfunction ContextMenuWrapper(props: IProps) {\n  const propsContext = useContext(PropsContext);\n\n  const onPress = useCallback(\n    (index) => {\n      ChatEmitter.emit('actionPressed', index, props.message);\n    },\n    [props.message]\n  );\n\n  const onLongPress = useCallback(() => {\n    if (Platform.OS === 'ios') {\n      ActionSheetIOS.showActionSheetWithOptions(\n        {\n          options: [\n            ...(propsContext.bubbleProps?.actions?.options.map(\n              (_) => _.title\n            ) as string[]),\n            propsContext.bubbleProps?.actions?.cancelButtonLabel ?? 'Close',\n          ],\n          cancelButtonIndex: propsContext.bubbleProps?.actions?.options.length,\n          destructiveButtonIndex:\n            propsContext.bubbleProps?.actions?.options.findIndex(\n              (_) => _.destructive\n            ) || -1,\n        },\n        onPress\n      );\n    }\n  }, [\n    onPress,\n    propsContext.bubbleProps?.actions?.cancelButtonLabel,\n    propsContext.bubbleProps?.actions?.options,\n  ]);\n\n  // If actions are not defined, just return the children\n  if (!propsContext.bubbleProps?.actions) return props.children;\n\n  // If actions are defined, but ios version is not supported, return the actionsheet\n  if (!contextMenuView) {\n    return (\n      <TouchableOpacity onLongPress={onLongPress}>\n        {props.children}\n      </TouchableOpacity>\n    );\n  }\n\n  if (Platform.OS === 'ios' && Platform.Version >= 13) {\n    return (\n      <contextMenuView.default\n        actions={propsContext.bubbleProps?.actions?.options}\n        onPress={(e: any) => onPress(e.nativeEvent.index)}\n      >\n        {props.children}\n      </contextMenuView.default>\n    );\n  }\n  return (\n    <contextMenuView.default\n      actions={propsContext.bubbleProps?.actions?.options}\n      onPress={(e: any) => onPress(e.nativeEvent.index)}\n    >\n      {props.children}\n    </contextMenuView.default>\n  );\n}\n\nexport { ContextMenuWrapper };\n"]},"metadata":{},"sourceType":"module"}