{"ast":null,"code":"import _taggedTemplateLiteralLoose from\"@babel/runtime/helpers/taggedTemplateLiteralLoose\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9;import _regeneratorRuntime from\"@babel/runtime/regenerator\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import React,{useState,useContext}from\"react\";import styled from\"styled-components/native\";import Text from\"../../components/Text.js\";import KeyboardAvoidingView from\"react-native-web/dist/exports/KeyboardAvoidingView\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import{FirebaseContext}from\"../../context/FirebaseContext\";import{UserContext}from\"../../context/UserContext\";import*as Yup from\"yup\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default NewPasswordScreen=function NewPasswordScreen(_ref){var navigation=_ref.navigation;var firebase=useContext(FirebaseContext);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState({Password:\"\",ConfirmPassword:\"\"}),_useState4=_slicedToArray(_useState3,2),newUser=_useState4[0],setNewUser=_useState4[1];var handleChange=function handleChange(prop){return function(event){setNewUser(_objectSpread(_objectSpread({},newUser),{},_defineProperty({},prop,event.target.value)));};};var stepOneValidationSchema=Yup.object({Password:Yup.string().required(\"This field is required\"),ConfirmPassword:Yup.string().when(\"Password\",{is:function is(val){return val&&val.length>0?true:false;},then:Yup.string().oneOf([Yup.ref(\"password\")],\"Both password need to be the same\")})});var NewPassword=function NewPassword(){return _regeneratorRuntime.async(function NewPassword$(_context){while(1){switch(_context.prev=_context.next){case 0:stepOneValidationSchema();_context.next=3;return _regeneratorRuntime.awrap(firebase.UpdatePassword(newUser.Password));case 3:case\"end\":return _context.stop();}}},null,null,null,Promise);};var ResetPassword=function ResetPassword(){var uid,userInfo;return _regeneratorRuntime.async(function ResetPassword$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regeneratorRuntime.awrap(firebase.getCurrentUser().uid);case 2:uid=_context2.sent;_context2.next=5;return _regeneratorRuntime.awrap(firebase.getUserInfo(uid));case 5:userInfo=_context2.sent;_context2.next=8;return _regeneratorRuntime.awrap(firebase.updateUserPassword(userInfo.email));case 8:case\"end\":return _context2.stop();}}},null,null,null,Promise);};return _jsx(Container,{children:_jsx(ScrollView,{children:_jsxs(KeyboardAvoidingView,{children:[_jsx(Main,{children:_jsx(Text,{title:true,semi:true,center:true,color:\"#88d498\",children:\"New password:\"})}),_jsxs(Auth,{children:[_jsxs(AuthContainer,{children:[_jsx(AuthTitle,{children:\" New password\"}),_jsx(AuthField,{autoCapitalize:\"none\",autoCompleteType:\"password\",autocorrect:false,secureTextEntry:true,onChange:handleChange(\"ConfirmPassword\")})]}),_jsxs(AuthContainer,{children:[_jsx(AuthTitle,{children:\" Confirm password\"}),_jsx(AuthField,{autoCapitalize:\"none\",autoCompleteType:\"password\",autocorrect:false,secureTextEntry:true,onChange:handleChange(\"Password\")})]})]}),_jsx(SignUpContainer,{onPress:NewPassword,disable:loading,children:loading?_jsx(Loading,{}):_jsx(Text,{bold:true,center:true,color:\"#ffffff\",children:\"Change password\"})}),_jsx(SignUp,{onPress:ResetPassword,children:_jsxs(Text,{small:true,center:true,children:[\"Forgot the password? \",_jsx(Text,{bold:true,color:\"#88d498\",children:\"Reset password\"})]})})]})})});};var Container=styled.KeyboardAvoidingView(_templateObject||(_templateObject=_taggedTemplateLiteralLoose([\"\\n    flex: 1; \\n\"])));var Main=styled.View(_templateObject2||(_templateObject2=_taggedTemplateLiteralLoose([\"\\n  margin-top: 80px; \\n  margin-bottom: 50px; \\n\"])));var Auth=styled.View(_templateObject3||(_templateObject3=_taggedTemplateLiteralLoose([\"\\n  margin: 16px 32px 32px; \\n\"])));var AuthContainer=styled.View(_templateObject4||(_templateObject4=_taggedTemplateLiteralLoose([\"\\n  margin-bottom: 32px;\\n\"])));var AuthTitle=styled(Text)(_templateObject5||(_templateObject5=_taggedTemplateLiteralLoose([\"\\n  color: #8e93a1;\\n  font-size: 12px; \\n  text-transform: uppercase; \\n  font-weight: 300; \\n\"])));var AuthField=styled.TextInput(_templateObject6||(_templateObject6=_taggedTemplateLiteralLoose([\"\\n  border-bottom-color: #8e93a1; \\n  border-bottom-width: 1px;\\n  height: 48px; \\n\"])));var SignUpContainer=styled.TouchableOpacity(_templateObject7||(_templateObject7=_taggedTemplateLiteralLoose([\"\\n  margin: 0 32px; \\n  height: 48px; \\n  align-items: center; \\n  justify-content: center; \\n  background-color: #88d498;\\n  border-radius: 6px;\\n\"])));var Loading=styled.ActivityIndicator.attrs(function(props){return{color:\"#fffffff\",size:\"small\"};})(_templateObject8||(_templateObject8=_taggedTemplateLiteralLoose([\"\"])));var SignUp=styled.TouchableOpacity(_templateObject9||(_templateObject9=_taggedTemplateLiteralLoose([\"\\n  margin-top: 16px; \\n\"])));","map":{"version":3,"names":["React","useState","useContext","styled","Text","FirebaseContext","UserContext","Yup","NewPasswordScreen","navigation","firebase","loading","setLoading","Password","ConfirmPassword","newUser","setNewUser","handleChange","prop","event","target","value","stepOneValidationSchema","object","string","required","when","is","val","length","then","oneOf","ref","NewPassword","UpdatePassword","ResetPassword","getCurrentUser","uid","getUserInfo","userInfo","updateUserPassword","email","Container","KeyboardAvoidingView","Main","View","Auth","AuthContainer","AuthTitle","AuthField","TextInput","SignUpContainer","TouchableOpacity","Loading","ActivityIndicator","attrs","props","color","size","SignUp"],"sources":["/Users/havardskjaerstein/Desktop/Achive/screens/settingTab/NewPasswordScreen.js"],"sourcesContent":["import React, {useState, useContext} from \"react\";\nimport styled from \"styled-components/native\"; \nimport Text from \"../../components/Text.js\";\nimport { KeyboardAvoidingView, ScrollView} from \"react-native\";\nimport {FirebaseContext} from \"../../context/FirebaseContext\";\nimport {UserContext} from \"../../context/UserContext\";\nimport * as Yup from \"yup\";\n\nexport default NewPasswordScreen = ({navigation}) => {\n\n  const firebase = useContext(FirebaseContext); \n  const [loading, setLoading] = useState(false); \n\n  const [newUser, setNewUser] = useState({\n    Password: \"\",\n    ConfirmPassword: \"\",\n  });\n\n  const handleChange = (prop) => (event) => {\n    setNewUser({ ...newUser, [prop]: event.target.value });\n  };\n\n  const stepOneValidationSchema = Yup.object({\n    Password: Yup.string().required(\"This field is required\"),\n\n    ConfirmPassword: Yup.string().when(\"Password\", {\n      is: (val) => (val && val.length > 0 ? true : false),\n      then: Yup.string().oneOf(\n        [Yup.ref(\"password\")],\n        \"Both password need to be the same\"\n      ),\n    }),\n  });\n\n  const NewPassword = async () => {\n    stepOneValidationSchema(); \n    await firebase.UpdatePassword(newUser.Password); \n  }\n\n  const ResetPassword = async () => {\n\n    const uid = await firebase.getCurrentUser().uid; \n    const userInfo = await firebase.getUserInfo(uid)\n    await firebase.updateUserPassword(userInfo.email); \n  }; \n\n  return(\n    <Container>\n      <ScrollView>\n      <KeyboardAvoidingView>\n       <Main>\n         <Text title semi center color=\"#88d498\">\n              New password: \n         </Text>\n        </Main>\n        <Auth>\n          <AuthContainer>\n            <AuthTitle> New password</AuthTitle>\n            <AuthField \n              autoCapitalize=\"none\" \n              autoCompleteType=\"password\" \n              autocorrect={false} \n              secureTextEntry={true}\n              onChange={handleChange(\"ConfirmPassword\")}\n            />\n          </AuthContainer>\n\n          <AuthContainer>\n            <AuthTitle> Confirm password</AuthTitle>\n            <AuthField \n              autoCapitalize=\"none\" \n              autoCompleteType=\"password\" \n              autocorrect={false} \n              secureTextEntry={true} \n              onChange={handleChange(\"Password\")}   \n            />\n          </AuthContainer>\n        </Auth>\n\n        <SignUpContainer onPress={NewPassword} disable={loading}>\n          {loading ? (<Loading/>) : (\n            <Text bold center color=\"#ffffff\">\n            Change password</Text>\n          )}\n        </SignUpContainer>\n\n        <SignUp onPress={ResetPassword}>\n          <Text small center> \n              Forgot the password? <Text bold color=\"#88d498\">Reset password</Text>\n          </Text>\n        </SignUp>\n        </KeyboardAvoidingView>\n      </ScrollView>\n     </Container>\n  );\n}\n\nconst Container = styled.KeyboardAvoidingView`\n    flex: 1; \n`;\n\nconst Main = styled.View`\n  margin-top: 80px; \n  margin-bottom: 50px; \n`;\n\nconst Auth = styled.View`\n  margin: 16px 32px 32px; \n`; \n\nconst AuthContainer = styled.View`\n  margin-bottom: 32px;\n`; \n\nconst AuthTitle = styled(Text)`\n  color: #8e93a1;\n  font-size: 12px; \n  text-transform: uppercase; \n  font-weight: 300; \n`; \n\nconst AuthField = styled.TextInput`\n  border-bottom-color: #8e93a1; \n  border-bottom-width: 1px;\n  height: 48px; \n`; \n\nconst SignUpContainer = styled.TouchableOpacity`\n  margin: 0 32px; \n  height: 48px; \n  align-items: center; \n  justify-content: center; \n  background-color: #88d498;\n  border-radius: 6px;\n`;\n\nconst Loading = styled.ActivityIndicator.attrs(props => ({\n  color: \"#fffffff\",\n  size: \"small\", \n}))``; \n\nconst SignUp = styled.TouchableOpacity`\n  margin-top: 16px; \n`; "],"mappings":"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"},"metadata":{},"sourceType":"module"}