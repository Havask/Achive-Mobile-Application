{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import $9Q8De$react,{useState as $9Q8De$useState,useImperativeHandle as $9Q8De$useImperativeHandle,Fragment as $9Q8De$Fragment}from\"react\";import $9Q8De$reactdom from\"react-dom\";import{VisuallyHidden as $9Q8De$VisuallyHidden}from\"@react-aria/visually-hidden\";function $parcel$export(e,n,v,s){Object.defineProperty(e,n,{get:v,set:s,enumerable:true,configurable:true});}var $319e236875307eab$exports={};$parcel$export($319e236875307eab$exports,\"announce\",function(){return $319e236875307eab$export$a9b970dcc4ae71a9;});$parcel$export($319e236875307eab$exports,\"clearAnnouncer\",function(){return $319e236875307eab$export$d10ae4f68404609a;});$parcel$export($319e236875307eab$exports,\"destroyAnnouncer\",function(){return $319e236875307eab$export$d8686216b8b81b2f;});var $319e236875307eab$var$LIVEREGION_TIMEOUT_DELAY=7000;var $319e236875307eab$var$liveRegionAnnouncer=$9Q8De$react.createRef();var $319e236875307eab$var$node=null;var $319e236875307eab$var$messageId=0;function $319e236875307eab$export$a9b970dcc4ae71a9(message){var assertiveness=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'assertive';var timeout=arguments.length>2&&arguments[2]!==undefined?arguments[2]:$319e236875307eab$var$LIVEREGION_TIMEOUT_DELAY;$319e236875307eab$var$ensureInstance(function(announcer){return announcer.announce(message,assertiveness,timeout);});}function $319e236875307eab$export$d10ae4f68404609a(assertiveness){$319e236875307eab$var$ensureInstance(function(announcer){return announcer.clear(assertiveness);});}function $319e236875307eab$export$d8686216b8b81b2f(){if($319e236875307eab$var$liveRegionAnnouncer.current){$9Q8De$reactdom.unmountComponentAtNode($319e236875307eab$var$node);document.body.removeChild($319e236875307eab$var$node);$319e236875307eab$var$node=null;}}function $319e236875307eab$var$ensureInstance(callback){if(!$319e236875307eab$var$liveRegionAnnouncer.current){$319e236875307eab$var$node=document.createElement('div');$319e236875307eab$var$node.dataset.liveAnnouncer='true';document.body.prepend($319e236875307eab$var$node);$9Q8De$reactdom.render($9Q8De$react.createElement($319e236875307eab$var$LiveRegionAnnouncer,{ref:$319e236875307eab$var$liveRegionAnnouncer}),$319e236875307eab$var$node,function(){return callback($319e236875307eab$var$liveRegionAnnouncer.current);});}else callback($319e236875307eab$var$liveRegionAnnouncer.current);}var $319e236875307eab$var$LiveRegionAnnouncer=$9Q8De$react.forwardRef(function(_,ref){var _$9Q8De$useState=$9Q8De$useState([]),_$9Q8De$useState2=_slicedToArray(_$9Q8De$useState,2),assertiveMessages=_$9Q8De$useState2[0],setAssertiveMessages=_$9Q8De$useState2[1];var _$9Q8De$useState3=$9Q8De$useState([]),_$9Q8De$useState4=_slicedToArray(_$9Q8De$useState3,2),politeMessages=_$9Q8De$useState4[0],setPoliteMessages=_$9Q8De$useState4[1];var clear=function clear(assertiveness){if(!assertiveness||assertiveness==='assertive')setAssertiveMessages([]);if(!assertiveness||assertiveness==='polite')setPoliteMessages([]);};var $319e236875307eab$export$a9b970dcc4ae71a9=function $319e236875307eab$export$a9b970dcc4ae71a9(message1){var assertiveness=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'assertive';var timeout=arguments.length>2&&arguments[2]!==undefined?arguments[2]:$319e236875307eab$var$LIVEREGION_TIMEOUT_DELAY;var id=$319e236875307eab$var$messageId++;if(assertiveness==='assertive')setAssertiveMessages(function(messages){return[].concat(_toConsumableArray(messages),[{id:id,text:message1}]);});else setPoliteMessages(function(messages){return[].concat(_toConsumableArray(messages),[{id:id,text:message1}]);});if(message1!=='')setTimeout(function(){if(assertiveness==='assertive')setAssertiveMessages(function(messages){return messages.filter(function(message){return message.id!==id;});});else setPoliteMessages(function(messages){return messages.filter(function(message){return message.id!==id;});});},timeout);};$9Q8De$useImperativeHandle(ref,function(){return{announce:$319e236875307eab$export$a9b970dcc4ae71a9,clear:clear};});return $9Q8De$react.createElement($9Q8De$Fragment,null,$9Q8De$react.createElement($319e236875307eab$var$MessageBlock,{\"aria-live\":\"assertive\"},assertiveMessages.map(function(message){return $9Q8De$react.createElement(\"div\",{key:message.id},message.text);})),$9Q8De$react.createElement($319e236875307eab$var$MessageBlock,{\"aria-live\":\"polite\"},politeMessages.map(function(message){return $9Q8De$react.createElement(\"div\",{key:message.id},message.text);})));});function $319e236875307eab$var$MessageBlock(_ref){var children=_ref.children,ariaLive=_ref['aria-live'];return $9Q8De$react.createElement($9Q8De$VisuallyHidden,{role:\"log\",\"aria-live\":ariaLive,\"aria-relevant\":\"additions\"},children);}export{$319e236875307eab$export$a9b970dcc4ae71a9 as announce,$319e236875307eab$export$d10ae4f68404609a as clearAnnouncer,$319e236875307eab$export$d8686216b8b81b2f as destroyAnnouncer};","map":{"version":3,"mappings":"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","names":["$319e236875307eab$var$LIVEREGION_TIMEOUT_DELAY","$319e236875307eab$var$liveRegionAnnouncer","$9Q8De$react","createRef","$319e236875307eab$var$node","$319e236875307eab$var$messageId","$319e236875307eab$export$a9b970dcc4ae71a9","message","assertiveness","timeout","$319e236875307eab$var$ensureInstance","announcer","announce","$319e236875307eab$export$d10ae4f68404609a","clear","$319e236875307eab$export$d8686216b8b81b2f","current","$9Q8De$reactdom","unmountComponentAtNode","document","body","removeChild","callback","createElement","dataset","liveAnnouncer","prepend","render","$319e236875307eab$var$LiveRegionAnnouncer","ref","forwardRef","_","$9Q8De$useState","assertiveMessages","setAssertiveMessages","politeMessages","setPoliteMessages","message1","id","messages","text","setTimeout","filter","$9Q8De$useImperativeHandle","$9Q8De$Fragment","$319e236875307eab$var$MessageBlock","map","key","children","ariaLive","$9Q8De$VisuallyHidden","role"],"sources":["packages/@react-aria/live-announcer/src/LiveAnnouncer.tsx"],"sourcesContent":["/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport React, {Fragment, ReactNode, RefObject, useImperativeHandle, useState} from 'react';\nimport ReactDOM from 'react-dom';\nimport {VisuallyHidden} from '@react-aria/visually-hidden';\n\ntype Assertiveness = 'assertive' | 'polite';\ninterface Announcer {\n  announce(message: string, assertiveness: Assertiveness, timeout: number): void,\n  clear(assertiveness: Assertiveness): void\n}\n\n/* Inspired by https://github.com/AlmeroSteyn/react-aria-live */\nconst LIVEREGION_TIMEOUT_DELAY = 7000;\n\nlet liveRegionAnnouncer = React.createRef<Announcer>();\nlet node: HTMLElement = null;\nlet messageId = 0;\n\n/**\n * Announces the message using screen reader technology.\n */\nexport function announce(\n  message: string,\n  assertiveness: Assertiveness = 'assertive',\n  timeout = LIVEREGION_TIMEOUT_DELAY\n) {\n  ensureInstance(announcer => announcer.announce(message, assertiveness, timeout));\n}\n\n/**\n * Stops all queued announcements.\n */\nexport function clearAnnouncer(assertiveness: Assertiveness) {\n  ensureInstance(announcer => announcer.clear(assertiveness));\n}\n\n/**\n * Removes the announcer from the DOM.\n */\nexport function destroyAnnouncer() {\n  if (liveRegionAnnouncer.current) {\n    ReactDOM.unmountComponentAtNode(node);\n    document.body.removeChild(node);\n    node = null;\n  }\n}\n\n/**\n * Ensures we only have one instance of the announcer so that we don't have elements competing.\n */\nfunction ensureInstance(callback: (announcer: Announcer) => void) {\n  if (!liveRegionAnnouncer.current) {\n    node = document.createElement('div');\n    node.dataset.liveAnnouncer = 'true';\n    document.body.prepend(node);\n    ReactDOM.render(\n      <LiveRegionAnnouncer ref={liveRegionAnnouncer} />,\n      node,\n      () => callback(liveRegionAnnouncer.current)\n    );\n  } else {\n    callback(liveRegionAnnouncer.current);\n  }\n}\n\nconst LiveRegionAnnouncer = React.forwardRef((_, ref: RefObject<Announcer>) => {\n  let [assertiveMessages, setAssertiveMessages] = useState([]);\n  let [politeMessages, setPoliteMessages] = useState([]);\n\n  let clear = (assertiveness: Assertiveness) => {\n    if (!assertiveness || assertiveness === 'assertive') {\n      setAssertiveMessages([]);\n    }\n\n    if (!assertiveness || assertiveness === 'polite') {\n      setPoliteMessages([]);\n    }\n  };\n\n  let announce = (message: string, assertiveness = 'assertive', timeout = LIVEREGION_TIMEOUT_DELAY) => {\n    let id = messageId++;\n\n    if (assertiveness === 'assertive') {\n      setAssertiveMessages(messages => [...messages, {id, text: message}]);\n    } else {\n      setPoliteMessages(messages => [...messages, {id, text: message}]);\n    }\n\n    if (message !== '') {\n      setTimeout(() => {\n        if (assertiveness === 'assertive') {\n          setAssertiveMessages(messages => messages.filter(message => message.id !== id));\n        } else {\n          setPoliteMessages(messages => messages.filter(message => message.id !== id));\n        }\n      }, timeout);\n    }\n  };\n\n  useImperativeHandle(ref, () => ({\n    announce,\n    clear\n  }));\n\n  return (\n    <Fragment>\n      <MessageBlock aria-live=\"assertive\">\n        {assertiveMessages.map(message => <div key={message.id}>{message.text}</div>)}\n      </MessageBlock>\n      <MessageBlock aria-live=\"polite\">\n        {politeMessages.map(message => <div key={message.id}>{message.text}</div>)}\n      </MessageBlock>\n    </Fragment>\n  );\n});\n\ninterface MessageBlockProps {\n   children: ReactNode,\n   'aria-live': Assertiveness\n }\n\nfunction MessageBlock({children, 'aria-live': ariaLive}: MessageBlockProps) {\n  return (\n    <VisuallyHidden\n      role=\"log\"\n      aria-live={ariaLive}\n      aria-relevant=\"additions\">\n      {children}\n    </VisuallyHidden>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}