{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import React,{useState,useContext,useEffect}from\"react\";import styled from\"styled-components/native\";import KeyboardAvoidingView from\"react-native-web/dist/exports/KeyboardAvoidingView\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import Alert from\"react-native-web/dist/exports/Alert\";import{FirebaseContext}from\"../../context/FirebaseContext\";import{UserContext}from\"../../context/UserContext\";import Switch from\"react-native-web/dist/exports/Switch\";import{Box,Text,Pressable,Heading,IconButton,Icon,HStack,Avatar,VStack,Spacer,Center,Image,Divider,Stack,Button,FormControl,Input,Link,WarningOutlineIcon}from\"native-base\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default LogInScreen=function LogInScreen(_ref){var navigation=_ref.navigation;var firebase=useContext(FirebaseContext);var _useContext=useContext(UserContext),_useContext2=_slicedToArray(_useContext,2),User=_useContext2[0],setUser=_useContext2[1];var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),Isloggedin=_useState8[0],setIsloggedin=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),RememberMe=_useState10[0],setRememberMe=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),Valid=_useState12[0],setValid=_useState12[1];var handleLogin=function handleLogin(){var uid,userInfo,_uid,_userInfo;return _regeneratorRuntime.async(function handleLogin$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(RememberMe===true)){_context.next=21;break;}if(!(email&&password)){_context.next=19;break;}_context.prev=2;_context.next=5;return _regeneratorRuntime.awrap(firebase.SignInUser(email,password));case 5:console.log(\"uid\");_context.next=8;return _regeneratorRuntime.awrap(firebase.getCurrentUser().uid);case 8:uid=_context.sent;console.log(\"uid\",uid);_context.next=12;return _regeneratorRuntime.awrap(firebase.getUserInfo(uid));case 12:userInfo=_context.sent;setUser({username:userInfo.username,email:email,password:password,uid:uid,groups:userInfo.groups,profilePhotoUrl:userInfo.profilePhotoUrl,isLoggedIn:true});_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](2);setValid(true);case 19:_context.next=37;break;case 21:_context.prev=21;_context.next=24;return _regeneratorRuntime.awrap(firebase.SignInUser(email,password));case 24:_context.next=26;return _regeneratorRuntime.awrap(firebase.getCurrentUser().uid);case 26:_uid=_context.sent;console.log(\"uid\");_context.next=30;return _regeneratorRuntime.awrap(firebase.getUserInfo(_uid));case 30:_userInfo=_context.sent;setUser({username:_userInfo.username,email:_userInfo.email,password:_userInfo.password,uid:_uid,groups:_userInfo.groups,profilePhotoUrl:_userInfo.profilePhotoUrl,isLoggedIn:true});_context.next=37;break;case 34:_context.prev=34;_context.t1=_context[\"catch\"](21);setValid(true);case 37:case\"end\":return _context.stop();}}},null,null,[[2,16],[21,34]],Promise);};var toggleSwitch=function toggleSwitch(){return setRememberMe(function(previousState){return!previousState;});};return _jsx(Box,{children:_jsxs(Box,{pt:\"150\",p:\"7\",children:[_jsx(Box,{justifyContent:\"center\",alignItems:\"center\",children:_jsx(Image,{h:\"100\",w:\"200\",source:require(\"../../assets/logo.png\"),alt:\"Logo\"})}),_jsxs(VStack,{space:3,mt:\"5\",pt:\"12\",children:[_jsxs(FormControl,{isInvalid:Valid,children:[_jsx(FormControl.Label,{children:\"Email\"}),_jsx(Input,{autoCapitalize:\"none\",autoCompleteType:\"email\",autocorrect:false,keyboardType:\"email-address\",value:email,onChangeText:function onChangeText(email){return setEmail(email.trim());}}),_jsx(FormControl.Label,{children:\"Password\"}),_jsx(Input,{type:\"password\",autoCapitalize:\"none\",autoCompleteType:\"password\",autocorrect:false,secureTextEntry:true,value:password,onChangeText:function onChangeText(password){return setPassword(password.trim());}}),_jsx(FormControl.ErrorMessage,{leftIcon:_jsx(WarningOutlineIcon,{size:\"xs\"}),children:\"Wrong password or email.\"})]}),_jsx(Link,{_text:{fontSize:\"xs\",fontWeight:\"500\",color:\"#88d498\"},alignSelf:\"flex-end\",mt:\"1\",children:\"Forgot Password?\"}),_jsxs(HStack,{alignItems:\"center\",justifyContent:\"center\",space:4,children:[_jsx(Text,{children:\"Keep me logged in\"}),_jsx(Switch,{size:\"sm\",onValueChange:toggleSwitch,value:RememberMe})]}),_jsx(Button,{mt:\"3\",onPress:handleLogin,children:\"Sign in\"}),_jsxs(HStack,{mt:\"6\",justifyContent:\"center\",children:[_jsxs(Text,{fontSize:\"sm\",children:[\"I'm a new user.\",\" \"]}),_jsx(Link,{onPress:function onPress(){return navigation.push(\"SignUpScreen\");},_text:{color:\"#88d498\",fontWeight:\"medium\",fontSize:\"sm\"},href:\"#\",children:\"Sign Up\"})]})]})]})});};","map":{"version":3,"names":["React","useState","useContext","useEffect","styled","FirebaseContext","UserContext","Box","Text","Pressable","Heading","IconButton","Icon","HStack","Avatar","VStack","Spacer","Center","Image","Divider","Stack","Button","FormControl","Input","Link","WarningOutlineIcon","LogInScreen","navigation","firebase","User","setUser","email","setEmail","password","setPassword","loading","setLoading","Isloggedin","setIsloggedin","RememberMe","setRememberMe","Valid","setValid","handleLogin","SignInUser","console","log","getCurrentUser","uid","getUserInfo","userInfo","username","groups","profilePhotoUrl","isLoggedIn","toggleSwitch","previousState","require","trim","fontSize","fontWeight","color","push"],"sources":["/Users/havardskjaerstein/Desktop/Achive/screens/AuthScreen/logInScreen.js"],"sourcesContent":["import React, {useState, useContext, useEffect} from \"react\";\nimport styled from \"styled-components/native\"; \nimport { KeyboardAvoidingView, ScrollView, Alert} from \"react-native\";\nimport {FirebaseContext} from \"../../context/FirebaseContext\";\nimport {UserContext} from \"../../context/UserContext\";\nimport {Switch} from \"react-native\";\nimport {Box, Text, Pressable, Heading, IconButton, Icon, HStack, Avatar, \n  VStack, Spacer, Center, Image,Divider,Stack, Button, FormControl, Input, Link, WarningOutlineIcon} from \"native-base\";\n\nexport default LogInScreen = ({navigation}) => {\n\n  const firebase = useContext(FirebaseContext); \n  const [User, setUser] = useContext(UserContext); \n  const [email, setEmail] = useState(\"\"); \n  const [password, setPassword] = useState(\"\"); \n  const [loading, setLoading] = useState(false); \n  const [Isloggedin, setIsloggedin] = useState(\"\"); \n  const [RememberMe, setRememberMe] = useState(true);  \n  const [Valid, setValid] = useState(false);  \n    \n    \n  const handleLogin = async () => {\n\n    if(RememberMe === true){\n      if (email && password) {\n   \n        try{\n          await firebase.SignInUser(email, password);\n          console.log(\"uid\");\n          const uid = await firebase.getCurrentUser().uid; \n          console.log(\"uid\",uid);\n          const userInfo = await firebase.getUserInfo(uid)\n\n          setUser({\n            username: userInfo.username,\n            email: email, \n            password: password,\n            uid: uid, \n            groups: userInfo.groups, \n            profilePhotoUrl: userInfo.profilePhotoUrl,\n            isLoggedIn: true, \n          })\n\n        }catch{\n          setValid(true)\n        }\n      } \n    }\n    else{\n      try{\n        await firebase.SignInUser(email, password);\n        const uid =  await firebase.getCurrentUser().uid; \n        console.log(\"uid\");\n        const userInfo =  await firebase.getUserInfo(uid)\n    \n        setUser({\n          username: userInfo.username,\n          email: userInfo.email, \n          password: userInfo.password,\n          uid: uid, \n          groups: userInfo.groups, \n          profilePhotoUrl: userInfo.profilePhotoUrl,\n          isLoggedIn: true, \n        })\n      }catch{\n        setValid(true)\n    }}\n    }\n \n\n  const toggleSwitch = () => setRememberMe(previousState => !previousState);\n\n  return(\n    <Box>\n        <Box pt=\"150\" p=\"7\">\n          <Box justifyContent=\"center\" alignItems=\"center\">\n            <Image h=\"100\" w=\"200\" source={require(\"../../assets/logo.png\")} alt=\"Logo\"/>\n          </Box>\n\n          <VStack space={3} mt=\"5\" pt=\"12\">\n        \n              <FormControl isInvalid={Valid}>\n              <FormControl.Label>Email</FormControl.Label>\n              <Input \n                autoCapitalize=\"none\" \n                autoCompleteType=\"email\" \n                autocorrect={false} \n            \n                keyboardType=\"email-address\"\n                value={email}\n                onChangeText={email => setEmail(email.trim())}/>\n\n          <FormControl.Label>Password</FormControl.Label>\n              <Input \n               type=\"password\" \n               autoCapitalize=\"none\" \n               autoCompleteType=\"password\" \n               autocorrect={false} \n             \n               secureTextEntry={true}\n               value={password}\n               onChangeText={password => setPassword(password.trim())}/>\n\n              <FormControl.ErrorMessage leftIcon={<WarningOutlineIcon size=\"xs\" />}>\n                Wrong password or email.\n              </FormControl.ErrorMessage>\n\n            </FormControl>\n\n              <Link _text={{\n                fontSize: \"xs\",\n                fontWeight: \"500\",\n                color: \"#88d498\"\n            }} alignSelf=\"flex-end\" mt=\"1\">\n                Forgot Password?\n              </Link>\n\n          <HStack alignItems=\"center\" justifyContent=\"center\" space={4}>\n            <Text>Keep me logged in</Text>\n            <Switch \n              size=\"sm\" \n              onValueChange={toggleSwitch}\n              value={RememberMe}\n              />\n          </HStack>\n\n          <Button  mt=\"3\"  onPress={handleLogin}>\n            Sign in\n          </Button>\n\n          <HStack mt=\"6\" justifyContent=\"center\" >\n            <Text fontSize=\"sm\"  >\n              I'm a new user.{\" \"}\n            </Text>\n            <Link onPress={() => navigation.push(\"SignUpScreen\")} _text={{\n              color: \"#88d498\",\n              fontWeight: \"medium\",\n              fontSize: \"sm\"\n            }} href=\"#\">\n              Sign Up\n            </Link>\n          </HStack>\n        </VStack>\n      </Box>\n    </Box>\n  );\n}\n\n/*\n<Box>\n            <AuthContainer>\n              <AuthTitle>Email address</AuthTitle>\n              <AuthField \n                autoCapitalize=\"none\" \n                autoCompleteType=\"email\" \n                autocorrect={false} \n            \n                keyboardType=\"email-address\"\n                value={email}\n                onChangeText={email => setEmail(email.trim())}\n              />\n            </AuthContainer>\n\n            <AuthContainer>\n              <AuthTitle>password</AuthTitle>\n              <AuthField \n                autoCapitalize=\"none\" \n                autoCompleteType=\"password\" \n                autocorrect={false} \n              \n                secureTextEntry={true}\n                value={password}\n                onChangeText={password => setPassword(password.trim())}\n              />\n            </AuthContainer>\n          </Box>\n\n        <StayLoggedIn>\n            <Text small> \n                Keep me logged in </Text>\n          <SwitchView>\n            <Switch \n              trackColor={{ false: \"#767577\", true: \"#88d498\"}}\n              thumbColor={Isloggedin ? \"#88d498\" : \"#cccccc\"}\n              ios_backgroundColor=\"#3e3e3e\"\n              onValueChange={toggleSwitch}\n              value={RememberMe}\n            />\n          </SwitchView>\n        </StayLoggedIn>\n\n          <SignInContainer onPress={handleLogin} disable={loading}>\n            {loading ? (<Loading/>) : (\n            <Text bold center color=\"#ffffff\">\n              Sign In</Text>\n            )}\n          </SignInContainer>\n\n          <SignUp onPress={() => navigation.push(\"SignUpScreen\")}>\n            <Text small center> \n                New to Achive? <Text bold color=\"#88d498\">Sign Up</Text></Text>\n          </SignUp>\n\n      </Box>\n      */\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}