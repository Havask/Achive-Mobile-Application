{"ast":null,"code":"function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}import dayjs from'dayjs';import React,{useCallback,useEffect,useRef}from'react';import ActivityIndicator from\"react-native-web/dist/exports/ActivityIndicator\";import Keyboard from\"react-native-web/dist/exports/Keyboard\";import KeyboardAvoidingView from\"react-native-web/dist/exports/KeyboardAvoidingView\";import Platform from\"react-native-web/dist/exports/Platform\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import View from\"react-native-web/dist/exports/View\";import{SafeAreaView}from'react-native-safe-area-context';import{Footer}from\"./Footer\";import{Header}from\"./Header\";import{List}from\"./List\";export var PropsContext=React.createContext({});export var Chatty=React.forwardRef(function(props,ref){var listRef=useRef();var messages=props.messages;useEffect(function(){var listener=Keyboard.addListener('keyboardDidShow',function(){if(listRef.current){var _listRef$current;(_listRef$current=listRef.current)===null||_listRef$current===void 0?void 0:_listRef$current.scrollToEnd(true);}else if(ref){var _ref$current;(_ref$current=ref.current)===null||_ref$current===void 0?void 0:_ref$current.scrollToEnd(true);}else{console.warn('No ref found');}});return function(){listener.remove();};},[ref]);useEffect(function(){if(props!==null&&props!==void 0&&props.setDateLocale){dayjs.locale(props.setDateLocale);}},[props.setDateLocale]);var renderLoading=useCallback(function(){return React.createElement(View,{style:[styles.loadingContainer]},React.createElement(ActivityIndicator,null));},[]);return React.createElement(SafeAreaView,null,React.createElement(PropsContext.Provider,{value:props},props!==null&&props!==void 0&&props.renderHeader?props.renderHeader(props.headerProps):React.createElement(Header,props.headerProps),React.createElement(KeyboardAvoidingView,{behavior:Platform.select({android:'position',ios:'position'}),keyboardVerticalOffset:Platform.select({android:20})},props.messages.length<1?renderLoading():React.createElement(React.Fragment,null,React.createElement(List,_extends({data:messages,ref:ref!==null&&ref!==void 0?ref:listRef,rowRenderer:props!==null&&props!==void 0&&props.renderBubble?props.renderBubble:undefined},props.listProps)),props!==null&&props!==void 0&&props.renderFooter?props.renderFooter(props.footerProps):React.createElement(Footer,_extends({},props.footerProps,{replyingTo:props.replyingTo}))))));});export var styles=StyleSheet.create({loadingContainer:{height:'90%',justifyContent:'center',alignContent:'center',alignItems:'center'}});","map":{"version":3,"mappings":"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","names":["dayjs","React","useCallback","useEffect","useRef","SafeAreaView","Footer","Header","List","PropsContext","createContext","Chatty","forwardRef","props","ref","listRef","messages","listener","Keyboard","addListener","current","scrollToEnd","console","warn","remove","setDateLocale","locale","renderLoading","View","style","styles","loadingContainer","ActivityIndicator","Provider","value","renderHeader","headerProps","KeyboardAvoidingView","behavior","Platform","select","android","ios","keyboardVerticalOffset","length","data","rowRenderer","renderBubble","undefined","listProps","renderFooter","footerProps","replyingTo","StyleSheet","create","height","justifyContent","alignContent","alignItems"],"sources":["Chatty.tsx"],"sourcesContent":["import dayjs from 'dayjs';\nimport type { ForwardedRef } from 'react';\nimport React, { useCallback, useEffect, useRef } from 'react';\nimport {\n  ActivityIndicator,\n  Keyboard,\n  KeyboardAvoidingView,\n  Platform,\n  StyleSheet,\n  View,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { Footer } from './Footer';\nimport { Header } from './Header';\nimport { List } from './List';\nimport type { IChatty, ListRef } from './types/Chatty.types';\n\nexport const PropsContext = React.createContext<IChatty>({} as IChatty);\n\nexport const Chatty = React.forwardRef(\n  (props: IChatty, ref: ForwardedRef<ListRef>) => {\n    const listRef = useRef<ListRef>();\n    const { messages } = props;\n\n    /* This is a way to scroll to the end of the list when the keyboard is shown. */\n    useEffect(() => {\n      const listener = Keyboard.addListener('keyboardDidShow', () => {\n        if (listRef.current) {\n          listRef.current?.scrollToEnd(true);\n        } else if (ref) {\n          //@ts-ignore\n          ref.current?.scrollToEnd(true);\n        } else {\n          console.warn('No ref found');\n        }\n      });\n\n      return () => {\n        listener.remove();\n      };\n    }, [ref]);\n\n    useEffect(() => {\n      if (props?.setDateLocale) {\n        dayjs.locale(props.setDateLocale);\n      }\n    }, [props.setDateLocale]);\n\n    const renderLoading = useCallback(() => {\n      return (\n        <View style={[styles.loadingContainer]}>\n          <ActivityIndicator />\n        </View>\n      );\n    }, []);\n\n    return (\n      <SafeAreaView>\n        <PropsContext.Provider value={props}>\n          {props?.renderHeader ? (\n            props.renderHeader(props.headerProps)\n          ) : (\n            <Header {...props.headerProps} />\n          )}\n          <KeyboardAvoidingView\n            behavior={Platform.select({\n              android: 'position',\n              ios: 'position',\n            })}\n            keyboardVerticalOffset={Platform.select({\n              android: 20,\n            })}\n          >\n            {props.messages.length < 1 ? (\n              renderLoading()\n            ) : (\n              <>\n                <List\n                  data={messages}\n                  //@ts-ignore\n                  ref={ref ?? listRef}\n                  rowRenderer={\n                    props?.renderBubble ? props.renderBubble : undefined\n                  }\n                  {...props.listProps}\n                />\n                {props?.renderFooter ? (\n                  props.renderFooter(props.footerProps)\n                ) : (\n                  <Footer\n                    {...props.footerProps}\n                    replyingTo={props.replyingTo}\n                  />\n                )}\n              </>\n            )}\n          </KeyboardAvoidingView>\n        </PropsContext.Provider>\n      </SafeAreaView>\n    );\n  }\n);\n\nexport const styles = StyleSheet.create({\n  loadingContainer: {\n    height: '90%',\n    justifyContent: 'center',\n    alignContent: 'center',\n    alignItems: 'center',\n  },\n});\n"]},"metadata":{},"sourceType":"module"}