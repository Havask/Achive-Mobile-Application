{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import React,{useCallback,useContext,useMemo,useState}from'react';import Button from\"react-native-web/dist/exports/Button\";import ImageBackground from\"react-native-web/dist/exports/ImageBackground\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Text from\"react-native-web/dist/exports/Text\";import TextInput from\"react-native-web/dist/exports/TextInput\";import View from\"react-native-web/dist/exports/View\";import{ScrollView,TouchableOpacity}from'react-native-gesture-handler';import Animated,{FadeInDown,FadeOutDown}from'react-native-reanimated';import{PropsContext}from\"./Chatty\";import{MediaType}from\"./types/Chatty.types\";import{selectImage}from\"./utils/imagePicker\";function _Footer(props){var _props$mentionStyles3,_props$mentionStyles4,_props$replyStyles,_props$replyStyles2,_props$replyStyles3,_props$value,_props$placeholder;var propsContext=useContext(PropsContext);var _useState=useState(''),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var _useState3=useState(['JohnDoe']),_useState4=_slicedToArray(_useState3,1),mentions=_useState4[0];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),foundedMentions=_useState6[0],setFoundedMentions=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),image=_useState8[0],setImage=_useState8[1];var cuttedText=useMemo(function(){if(props.replyingTo){return props.replyingTo.text.slice(0,100)+'...';}return null;},[props===null||props===void 0?void 0:props.replyingTo]);var onChangeText=useCallback(function(text){var foundedMentions=[];text.split(' ').forEach(function(word){foundedMentions.push.apply(foundedMentions,_toConsumableArray(mentions.filter(function(mention){console.log(text,mention.indexOf(word));return mention.toLowerCase().indexOf(word.toLowerCase().replace('@',''))!=-1;})));});setFoundedMentions(foundedMentions);props.onChangeText(text);setMessage(text);},[props,mentions]);var onPressSend=useCallback(function(){props.onPressSend({text:message,repliedTo:props.replyingTo,media:image});setMessage('');setImage([]);},[message,props,image]);var onPressMention=function onPressMention(target){setMessage(function(prev){var messagesArray=prev.split(' ');var lastMessageIndex=messagesArray.length-1;var lastMessage=messagesArray[lastMessageIndex];prev=prev.replace(lastMessage,'@'+target);return prev;});setFoundedMentions([]);};var renderMenu=useCallback(function(){if(message&&foundedMentions.length>0){var splittedWords=message.split(' ');if(splittedWords[splittedWords.length-1].startsWith('@')){var _props$mentionStyles$,_props$mentionStyles;return React.createElement(Animated.View,{entering:FadeInDown,exiting:FadeOutDown,style:(_props$mentionStyles$=(_props$mentionStyles=props.mentionStyles)===null||_props$mentionStyles===void 0?void 0:_props$mentionStyles.containerStyle)!==null&&_props$mentionStyles$!==void 0?_props$mentionStyles$:styles.mentionContainer},foundedMentions.map(function(mention){var _props$mentionStyles$2,_props$mentionStyles2;return React.createElement(TouchableOpacity,{onPress:function onPress(){return onPressMention(mention);}},React.createElement(Text,{style:(_props$mentionStyles$2=(_props$mentionStyles2=props.mentionStyles)===null||_props$mentionStyles2===void 0?void 0:_props$mentionStyles2.labelStyle)!==null&&_props$mentionStyles$2!==void 0?_props$mentionStyles$2:styles.mentionLabel},\"@\",mention));}));}}return null;},[foundedMentions,message,(_props$mentionStyles3=props.mentionStyles)===null||_props$mentionStyles3===void 0?void 0:_props$mentionStyles3.containerStyle,(_props$mentionStyles4=props.mentionStyles)===null||_props$mentionStyles4===void 0?void 0:_props$mentionStyles4.labelStyle]);var _onKeyPress=useCallback(function(key){if(key===' '){setFoundedMentions([]);}},[]);var onPressImage=useCallback(function _callee(){return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:selectImage().then(function(r){var assets={type:MediaType.Image,uri:r!==null&&r!==void 0&&r.assets?r.assets[0].uri:r.uri,base64:r!==null&&r!==void 0&&r.assets?r.assets[0].base64:r.base64};if(image){setImage([].concat(_toConsumableArray(image),[assets]));}else{setImage([assets]);}});case 1:case\"end\":return _context.stop();}}},null,null,null,Promise);},[image]);return React.createElement(View,{style:image&&image.length>0&&{position:'absolute',bottom:-70,backgroundColor:'#fff'}},props.replyingTo&&React.createElement(Animated.View,{entering:FadeInDown,exiting:FadeOutDown,style:[styles.reply,(_props$replyStyles=props.replyStyles)===null||_props$replyStyles===void 0?void 0:_props$replyStyles.containerStyle]},React.createElement(View,{style:styles.replyBody},React.createElement(Text,{style:[styles.replyUsername,(_props$replyStyles2=props.replyStyles)===null||_props$replyStyles2===void 0?void 0:_props$replyStyles2.usernameStyle]},props.replyingTo.user.username),React.createElement(Text,{style:(_props$replyStyles3=props.replyStyles)===null||_props$replyStyles3===void 0?void 0:_props$replyStyles3.labelStyle},cuttedText)),propsContext.footerProps.closeReplyButton?propsContext.footerProps.closeReplyButton(props):React.createElement(Button,{title:\"cancel\",onPress:props.onPressCancelReply})),renderMenu(),React.createElement(View,{style:[styles.container,props.containerStyle]},image&&image.length>0&&React.createElement(ScrollView,{horizontal:true,pagingEnabled:true},image.map(function(_image){return React.createElement(TouchableOpacity,{onPress:function onPress(){return setImage(function(prev){return prev&&prev.filter(function(v){return v!==_image;});});},style:styles.media},React.createElement(ImageBackground,{style:[styles.mediaOverlay,{marginBottom:15}],source:{uri:_image.uri},imageStyle:{borderRadius:15}},React.createElement(View,{style:styles.media},React.createElement(View,{style:styles.imageClearButton},React.createElement(Text,{style:{color:'#fff',textAlign:'center'}},\"x\")))));}),React.createElement(TouchableOpacity,{onPress:onPressImage},React.createElement(View,{style:styles.addMore},React.createElement(Text,{style:{fontSize:20,color:'#ccc'}},\"+\")))),React.createElement(View,{style:{flexDirection:'row',alignItems:'center'}},React.createElement(TextInput,{value:(_props$value=props.value)!==null&&_props$value!==void 0?_props$value:message,onChangeText:onChangeText,style:[propsContext!==null&&propsContext!==void 0&&propsContext.enableImageUploads?styles.shortedTextInput:styles.textInput,props===null||props===void 0?void 0:props.inputStyle],placeholder:(_props$placeholder=props===null||props===void 0?void 0:props.placeholder)!==null&&_props$placeholder!==void 0?_props$placeholder:'Type a message...',onKeyPress:function onKeyPress(e){return _onKeyPress(e.nativeEvent.key);}}),(propsContext===null||propsContext===void 0?void 0:propsContext.enableImageUploads)&&React.createElement(React.Fragment,null,props!==null&&props!==void 0&&props.renderImageAction?props.renderImageAction({onPressImage:onPressImage}):React.createElement(TouchableOpacity,{onPress:onPressImage,style:{paddingHorizontal:10}},React.createElement(Text,{style:{fontSize:20}},\"\\uD83D\\uDCF7\"))),props!==null&&props!==void 0&&props.sendButton?props.sendButton({onPressSend:onPressSend}):React.createElement(Button,{title:\"Send\",onPress:onPressSend,color:\"#0084ff\"}))));}var styles=StyleSheet.create({container:{padding:10},textInput:{padding:10,width:'80%',borderWidth:1,borderColor:'#ccc'},shortedTextInput:{padding:10,width:'70%',borderWidth:1,borderColor:'#ccc'},button:{width:'20%',backgroundColor:'#fcba03'},reply:{flexDirection:'row',padding:10,backgroundColor:'#f5f5f5',borderLeftColor:'#c8faaf',borderLeftWidth:6},replyBody:{flex:1},replyUsername:{fontWeight:'bold'},addMore:{width:100,height:100,borderWidth:1,borderStyle:'dashed',borderRadius:15,justifyContent:'center',alignItems:'center',borderColor:'#ccc'},imageClearButton:{backgroundColor:'rgba(0,0,0,0.5)',width:18,height:18,marginLeft:10,marginTop:5,borderRadius:20,justifyContent:'center',alignItems:'center',alignContent:'center'},media:{width:110,height:100,borderRadius:15,marginRight:10,marginBottom:10},mediaOverlay:{width:100,height:100,backgroundColor:'rgba(0,0,0,0.2)',borderRadius:15},mentionContainer:{position:'absolute',bottom:50,width:'100%',padding:10,backgroundColor:'#E5EEFA'},mentionLabel:{padding:10,color:'#1939B7'}});export var Footer=React.memo(_Footer);","map":{"version":3,"mappings":"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","names":["React","useCallback","useContext","useMemo","useState","ScrollView","TouchableOpacity","Animated","FadeInDown","FadeOutDown","PropsContext","MediaType","selectImage","_Footer","props","propsContext","message","setMessage","mentions","foundedMentions","setFoundedMentions","image","setImage","cuttedText","replyingTo","text","slice","onChangeText","split","forEach","word","push","filter","mention","console","log","indexOf","toLowerCase","replace","onPressSend","repliedTo","media","onPressMention","target","prev","messagesArray","lastMessageIndex","length","lastMessage","renderMenu","splittedWords","startsWith","View","entering","exiting","style","mentionStyles","_props$mentionStyles","containerStyle","styles","mentionContainer","map","onPress","Text","_props$mentionStyles2","labelStyle","mentionLabel","_props$mentionStyles3","_props$mentionStyles4","onKeyPress","key","onPressImage","then","r","assets","type","Image","uri","base64","position","bottom","backgroundColor","reply","replyStyles","_props$replyStyles","replyBody","replyUsername","_props$replyStyles2","usernameStyle","user","username","_props$replyStyles3","footerProps","closeReplyButton","Button","title","onPressCancelReply","container","horizontal","pagingEnabled","_image","v","ImageBackground","mediaOverlay","marginBottom","source","imageStyle","borderRadius","imageClearButton","color","textAlign","addMore","fontSize","flexDirection","alignItems","TextInput","value","enableImageUploads","shortedTextInput","textInput","inputStyle","placeholder","e","nativeEvent","renderImageAction","paddingHorizontal","sendButton","StyleSheet","create","padding","width","borderWidth","borderColor","button","borderLeftColor","borderLeftWidth","flex","fontWeight","height","borderStyle","justifyContent","marginLeft","marginTop","alignContent","marginRight","Footer","memo"],"sources":["Footer.tsx"],"sourcesContent":["import React, { useCallback, useContext, useMemo, useState } from 'react';\nimport {\n  Button,\n  ImageBackground,\n  StyleSheet,\n  Text,\n  TextInput,\n  View,\n} from 'react-native';\nimport { ScrollView, TouchableOpacity } from 'react-native-gesture-handler';\nimport Animated, { FadeInDown, FadeOutDown } from 'react-native-reanimated';\nimport { PropsContext } from './Chatty';\nimport { IFooterProps, IMedia, MediaType } from './types/Chatty.types';\nimport { selectImage } from './utils/imagePicker';\n\nfunction _Footer(props: IFooterProps) {\n  const propsContext = useContext(PropsContext);\n  const [message, setMessage] = useState<string>('');\n  const [mentions] = useState(['JohnDoe']);\n  const [foundedMentions, setFoundedMentions] = useState<string[]>([]);\n  const [image, setImage] = useState<IMedia[] | undefined>();\n\n  const cuttedText = useMemo(() => {\n    if (props.replyingTo) {\n      return props.replyingTo.text.slice(0, 100) + '...';\n    }\n\n    return null;\n  }, [props?.replyingTo]);\n\n  const onChangeText = useCallback(\n    (text: string) => {\n      const foundedMentions: string[] = [];\n\n      // Iterate over all text\n      text.split(' ').forEach((word) => {\n        foundedMentions.push(\n          // Check and push if word exists in mentions\n          ...mentions.filter((mention) => {\n            console.log(text, mention.indexOf(word));\n            return (\n              mention\n                .toLowerCase()\n                .indexOf(word.toLowerCase().replace('@', '')) != -1\n            );\n          })\n        );\n      });\n\n      setFoundedMentions(foundedMentions);\n\n      props.onChangeText(text);\n      setMessage(text);\n    },\n    [props, mentions]\n  );\n\n  const onPressSend = useCallback(() => {\n    props.onPressSend({\n      text: message,\n      repliedTo: props.replyingTo,\n      media: image,\n    });\n    setMessage('');\n    setImage([]);\n  }, [message, props, image]);\n\n  const onPressMention = (target: string) => {\n    setMessage((prev) => {\n      const messagesArray = prev.split(' ');\n      const lastMessageIndex = messagesArray.length - 1;\n      const lastMessage = messagesArray[lastMessageIndex];\n\n      prev = prev.replace(lastMessage, '@' + target);\n\n      return prev;\n    });\n\n    setFoundedMentions([]);\n  };\n\n  const renderMenu = useCallback(() => {\n    if (message && foundedMentions.length > 0) {\n      const splittedWords = message.split(' ');\n\n      if (splittedWords[splittedWords.length - 1].startsWith('@')) {\n        return (\n          <Animated.View\n            entering={FadeInDown}\n            exiting={FadeOutDown}\n            style={\n              props.mentionStyles?.containerStyle ?? styles.mentionContainer\n            }\n          >\n            {foundedMentions.map((mention) => (\n              <TouchableOpacity onPress={() => onPressMention(mention)}>\n                <Text\n                  style={props.mentionStyles?.labelStyle ?? styles.mentionLabel}\n                >\n                  @{mention}\n                </Text>\n              </TouchableOpacity>\n            ))}\n          </Animated.View>\n        );\n      }\n    }\n\n    return null;\n  }, [\n    foundedMentions,\n    message,\n    props.mentionStyles?.containerStyle,\n    props.mentionStyles?.labelStyle,\n  ]);\n\n  const onKeyPress = useCallback((key: string) => {\n    if (key === ' ') {\n      setFoundedMentions([]);\n    }\n  }, []);\n\n  const onPressImage = useCallback(async () => {\n    selectImage().then((r) => {\n      const assets = {\n        type: MediaType.Image,\n        uri: r?.assets ? r.assets[0].uri : r.uri,\n        base64: r?.assets ? r.assets[0].base64 : r.base64,\n      };\n      if (image) {\n        setImage([...image, assets]);\n      } else {\n        setImage([assets]);\n      }\n    });\n  }, [image]);\n\n  return (\n    <View\n      style={\n        image &&\n        image.length > 0 && {\n          position: 'absolute',\n          bottom: -70,\n          backgroundColor: '#fff',\n        }\n      }\n    >\n      {props.replyingTo && (\n        <Animated.View\n          entering={FadeInDown}\n          exiting={FadeOutDown}\n          style={[styles.reply, props.replyStyles?.containerStyle]}\n        >\n          <View style={styles.replyBody}>\n            <Text\n              style={[styles.replyUsername, props.replyStyles?.usernameStyle]}\n            >\n              {props.replyingTo.user.username}\n            </Text>\n            <Text style={props.replyStyles?.labelStyle}>{cuttedText}</Text>\n          </View>\n          {propsContext.footerProps.closeReplyButton ? (\n            propsContext.footerProps.closeReplyButton(props)\n          ) : (\n            <Button title=\"cancel\" onPress={props.onPressCancelReply} />\n          )}\n        </Animated.View>\n      )}\n\n      {renderMenu()}\n\n      <View style={[styles.container, props.containerStyle]}>\n        {image && image.length > 0 && (\n          <ScrollView horizontal pagingEnabled>\n            {image.map((_image) => (\n              <TouchableOpacity\n                onPress={() =>\n                  setImage((prev) => prev && prev.filter((v) => v !== _image))\n                }\n                style={styles.media}\n              >\n                <ImageBackground\n                  style={[styles.mediaOverlay, { marginBottom: 15 }]}\n                  source={{ uri: _image.uri }}\n                  imageStyle={{\n                    borderRadius: 15,\n                  }}\n                >\n                  <View style={styles.media}>\n                    <View style={styles.imageClearButton}>\n                      <Text style={{ color: '#fff', textAlign: 'center' }}>\n                        x\n                      </Text>\n                    </View>\n                  </View>\n                </ImageBackground>\n              </TouchableOpacity>\n            ))}\n\n            <TouchableOpacity onPress={onPressImage}>\n              <View style={styles.addMore}>\n                <Text style={{ fontSize: 20, color: '#ccc' }}>+</Text>\n              </View>\n            </TouchableOpacity>\n          </ScrollView>\n        )}\n\n        <View style={{ flexDirection: 'row', alignItems: 'center' }}>\n          <TextInput\n            value={props.value ?? message}\n            onChangeText={onChangeText}\n            style={[\n              propsContext?.enableImageUploads\n                ? styles.shortedTextInput\n                : styles.textInput,\n\n              props?.inputStyle,\n            ]}\n            placeholder={props?.placeholder ?? 'Type a message...'}\n            onKeyPress={(e) => onKeyPress(e.nativeEvent.key)}\n          />\n\n          {propsContext?.enableImageUploads && (\n            <>\n              {props?.renderImageAction ? (\n                props.renderImageAction({\n                  onPressImage,\n                })\n              ) : (\n                <TouchableOpacity\n                  onPress={onPressImage}\n                  style={{ paddingHorizontal: 10 }}\n                >\n                  <Text style={{ fontSize: 20 }}>📷</Text>\n                </TouchableOpacity>\n              )}\n            </>\n          )}\n\n          {props?.sendButton ? (\n            props.sendButton({\n              onPressSend: onPressSend,\n            })\n          ) : (\n            <Button title=\"Send\" onPress={onPressSend} color=\"#0084ff\" />\n          )}\n        </View>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    padding: 10,\n  },\n  textInput: {\n    padding: 10,\n    width: '80%',\n    borderWidth: 1,\n    borderColor: '#ccc',\n  },\n  shortedTextInput: {\n    padding: 10,\n    width: '70%',\n    borderWidth: 1,\n    borderColor: '#ccc',\n  },\n  button: {\n    width: '20%',\n    backgroundColor: '#fcba03',\n  },\n  reply: {\n    flexDirection: 'row',\n    padding: 10,\n    backgroundColor: '#f5f5f5',\n    borderLeftColor: '#c8faaf',\n    borderLeftWidth: 6,\n  },\n  replyBody: {\n    flex: 1,\n  },\n  replyUsername: {\n    fontWeight: 'bold',\n  },\n\n  addMore: {\n    width: 100,\n    height: 100,\n    borderWidth: 1,\n    borderStyle: 'dashed',\n    borderRadius: 15,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderColor: '#ccc',\n  },\n  imageClearButton: {\n    backgroundColor: 'rgba(0,0,0,0.5)',\n    width: 18,\n    height: 18,\n    marginLeft: 10,\n    marginTop: 5,\n    borderRadius: 20,\n    justifyContent: 'center',\n    alignItems: 'center',\n    alignContent: 'center',\n  },\n  media: {\n    width: 110,\n    height: 100,\n    borderRadius: 15,\n    marginRight: 10,\n    marginBottom: 10,\n  },\n  mediaOverlay: {\n    width: 100,\n    height: 100,\n    backgroundColor: 'rgba(0,0,0,0.2)',\n    borderRadius: 15,\n  },\n  mentionContainer: {\n    position: 'absolute',\n    bottom: 50,\n    width: '100%',\n    padding: 10,\n    backgroundColor: '#E5EEFA',\n  },\n  mentionLabel: {\n    padding: 10,\n    color: '#1939B7',\n  },\n});\n\nexport const Footer = React.memo(_Footer);\n"]},"metadata":{},"sourceType":"module"}